# This file should ensure the existence of records required to run the application in every environment (production,
# development, test). The code here should be idempotent so that it can be executed at any point in every environment.
# The data can then be loaded with the bin/rails db:seed command (or created alongside the database with db:setup).

# シフト情報の初期データ（GASのテストコードから移植）
puts "シフト情報の初期データを作成中..."

# 現在の月のシフトデータを作成
current_date = Date.current
year = current_date.year
month = current_date.month

# 従業員IDのリスト（freee APIから取得した実際のID）
employee_ids = ["3313254", "3316116", "3316120", "3317741"]

# 既存のシフトデータを削除（同じ月のデータ）
Shift.where(shift_date: Date.new(year, month, 1)..Date.new(year, month, -1)).destroy_all

# GASのテストコードから移植したシフトデータ
# 従業員0（店長 太郎）: 週3回程度、18-20と20-23中心
shift_data_3313254 = [
  [1, "18:00", "20:00"], [2, "18:00", "20:00"], [4, "20:00", "23:00"], [5, "20:00", "23:00"], 
  [6, "20:00", "23:00"], [7, "18:00", "20:00"], [10, "18:00", "20:00"], [11, "18:00", "20:00"], 
  [13, "20:00", "23:00"], [14, "18:00", "20:00"], [16, "20:00", "23:00"], [17, "18:00", "20:00"], 
  [19, "20:00", "23:00"], [20, "18:00", "20:00"], [22, "20:00", "23:00"], [23, "18:00", "20:00"], 
  [25, "20:00", "23:00"], [26, "18:00", "20:00"], [27, "20:00", "23:00"], [29, "18:00", "20:00"], 
  [30, "20:00", "23:00"], [31, "18:00", "20:00"]
]

# 従業員1（テスト 太郎）: 週3回程度、20-23と18-20中心
shift_data_3316116 = [
  [1, "20:00", "23:00"], [3, "18:00", "20:00"], [4, "18:00", "20:00"], [6, "18:00", "20:00"], 
  [8, "20:00", "23:00"], [10, "18:00", "20:00"], [12, "18:00", "20:00"], [13, "20:00", "23:00"], 
  [14, "18:00", "20:00"], [16, "18:00", "20:00"], [18, "20:00", "23:00"], [20, "18:00", "20:00"], 
  [21, "20:00", "23:00"], [22, "18:00", "20:00"], [24, "18:00", "20:00"], [26, "20:00", "23:00"], 
  [27, "18:00", "20:00"], [28, "20:00", "23:00"], [30, "18:00", "20:00"]
]

# 従業員2（テスト 次郎）: 週3回程度、20-23と18-20中心
shift_data_3316120 = [
  [2, "20:00", "23:00"], [3, "20:00", "23:00"], [5, "18:00", "20:00"], [7, "20:00", "23:00"], 
  [9, "20:00", "23:00"], [10, "18:00", "20:00"], [12, "18:00", "20:00"], [13, "20:00", "23:00"], 
  [15, "18:00", "20:00"], [16, "20:00", "23:00"], [17, "18:00", "20:00"], [19, "20:00", "23:00"], 
  [20, "18:00", "20:00"], [21, "20:00", "23:00"], [23, "18:00", "20:00"], [24, "20:00", "23:00"], 
  [25, "18:00", "20:00"], [27, "20:00", "23:00"], [28, "18:00", "20:00"], [29, "20:00", "23:00"], 
  [30, "18:00", "20:00"]
]

# 従業員3（テスト 三郎）: 週3回程度、18-23中心
shift_data_3317741 = [
  [1, "18:00", "23:00"], [3, "18:00", "23:00"], [4, "18:00", "23:00"], [5, "18:00", "23:00"], 
  [7, "18:00", "23:00"], [8, "18:00", "23:00"], [10, "20:00", "23:00"], [11, "18:00", "23:00"], 
  [13, "18:00", "23:00"], [15, "18:00", "23:00"], [16, "18:00", "23:00"], [18, "20:00", "23:00"], 
  [19, "18:00", "23:00"], [20, "18:00", "23:00"], [22, "18:00", "23:00"], [24, "18:00", "23:00"], 
  [25, "20:00", "23:00"], [26, "18:00", "23:00"], [28, "18:00", "23:00"], [29, "18:00", "23:00"], 
  [31, "20:00", "23:00"]
]

# シフトデータのハッシュ
shift_data_hash = {
  "3313254" => shift_data_3313254,
  "3316116" => shift_data_3316116,
  "3316120" => shift_data_3316120,
  "3317741" => shift_data_3317741
}

# 各従業員のシフトを作成
shift_data_hash.each do |employee_id, shifts|
  shifts.each do |day, start_time, end_time|
    # 日付が月の範囲内かチェック
    max_day = Date.new(year, month, -1).day
    if day <= max_day
      date = Date.new(year, month, day)
      
      Shift.create!(
        employee_id: employee_id,
        shift_date: date,
        start_time: start_time,
        end_time: end_time,
        is_modified: false
      )
    end
  end
end

puts "シフト情報の初期データ作成完了"
puts "作成されたシフト数: #{Shift.count}"
puts "対象月: #{year}年#{month}月"
puts "従業員別シフト数:"
Shift.group(:employee_id).count.each do |employee_id, count|
  puts "  #{employee_id}: #{count}件"
end
