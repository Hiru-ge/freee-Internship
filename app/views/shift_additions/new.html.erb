<div class="form-container">
  <h1>シフト追加リクエスト</h1>
  <p class="form-description">追加したいシフトの詳細を入力してください。</p>
  
  <%= form_with url: shift_additions_path, method: :post, local: true, id: "addition-form" do |form| %>
    <%= form.hidden_field :request_type, value: 'addition' %>
    
    <div class="form-group">
      <div class="form-row">
        <label for="employee-select" class="form-label">追加シフトを依頼する従業員:</label>
        <%= form.select :employee_id, 
            options_for_select(@employees.map { |emp| [emp[:display_name], emp[:id]] }, params[:employee_id]),
            { prompt: "-- 従業員を選択 --" },
            { required: true, id: "employee-select", class: "form-input" } %>
      </div>
      <div class="form-help">
        ※ 追加シフトを依頼する従業員を選択してください
      </div>
    </div>
    
    <div class="form-group">
      <div class="form-row">
        <label for="shift-date" class="form-label">シフト日付:</label>
        <%= form.date_field :shift_date, 
            value: @date, 
            required: true, 
            id: "shift-date", 
            class: "form-input" %>
      </div>
    </div>
    
    <div class="form-group">
      <div class="form-row">
        <label class="form-label">シフト時間:</label>
        <div class="time-inputs">
          <%= form.time_field :start_time, 
              value: @start_time, 
              required: true, 
              id: "start-time", 
              class: "form-input" %>
          <span class="time-separator">～</span>
          <%= form.time_field :end_time, 
              value: @end_time, 
              required: true, 
              id: "end-time", 
              class: "form-input" %>
        </div>
      </div>
      <div class="form-help">
        ※ 追加したいシフトの時間を指定してください
      </div>
    </div>
    
    <div class="form-buttons">
      <%= form.submit "シフト追加を依頼", class: "form-button" %>
      <%= link_to "シフトページに戻る", shifts_path, class: "form-button secondary" %>
    </div>
  <% end %>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('addition-form');
    
    form.addEventListener('submit', function(e) {
      const employeeSelect = document.getElementById('employee-select');
      const shiftDate = document.getElementById('shift-date');
      const startTime = document.getElementById('start-time');
      const endTime = document.getElementById('end-time');
      
      if (!employeeSelect.value || !shiftDate.value || !startTime.value || !endTime.value) {
        e.preventDefault();
        if (window.showFlashMessage) {
          window.showFlashMessage('すべての項目を入力してください。', 'error');
        } else if (window.messageHandler) {
          window.messageHandler.show('すべての項目を入力してください。', 'error');
        } else {
          alert('すべての項目を入力してください。');
        }
        return;
      }
      
      // ローディング表示
      const submitButton = document.querySelector('button[type="submit"]');
      submitButton.disabled = true;
      submitButton.textContent = '送信中...';
    });
  });
</script>
