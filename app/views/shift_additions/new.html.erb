<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <!-- CSSは外部ファイルに分離済み -->
  </head>
  <body>
    <div class="shift-addition-container">
      <h1>シフト追加リクエスト</h1>
      
      <form id="addition-form" action="<%= shift_requests_path %>" method="post" class="shift-addition-form">
        <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
        <%= hidden_field_tag :request_type, 'addition' %>
        
        <div class="form-section">
          <h3>基本情報</h3>
          
          <div class="form-group">
            <label for="employee-select" class="form-label">従業員を選択してください:</label>
            <select id="employee-select" name="employee_id" class="employee-select" required>
              <option value="">-- 従業員を選択 --</option>
              <% @employees.each do |employee| %>
                <option value="<%= employee[:id] %>"><%= employee[:display_name] %></option>
              <% end %>
            </select>
            <div class="help-text">※ 追加シフトを依頼する従業員を選択してください</div>
          </div>
        </div>
        
        <div class="form-section">
          <h3>シフト詳細</h3>
          
          <div class="form-group">
            <label for="shift-date" class="form-label">シフト日付:</label>
            <input type="date" id="shift-date" name="shift_date" class="form-input" value="<%= @date %>" required>
          </div>
          
          <div class="form-group">
            <label class="form-label">シフト時間:</label>
            <div class="form-row">
              <div class="form-group">
                <label for="start-time" class="form-label">開始時間:</label>
                <input type="time" id="start-time" name="start_time" class="form-input" value="<%= @start %>" required>
              </div>
              <div class="time-separator">～</div>
              <div class="form-group">
                <label for="end-time" class="form-label">終了時間:</label>
                <input type="time" id="end-time" name="end_time" class="form-input" value="<%= @end %>" required>
              </div>
            </div>
            <div class="help-text">※ 追加したいシフトの時間を指定してください</div>
          </div>
        </div>
        
        <div class="form-actions">
          <button type="submit" class="submit-button">シフト追加を依頼</button>
          <a href="<%= shifts_path %>" class="cancel-button">キャンセル</a>
        </div>
      </form>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('addition-form');
        
        form.addEventListener('submit', function(e) {
          const employeeSelect = document.getElementById('employee-select');
          const shiftDate = document.getElementById('shift-date');
          const startTime = document.getElementById('start-time');
          const endTime = document.getElementById('end-time');
          
          if (!employeeSelect.value || !shiftDate.value || !startTime.value || !endTime.value) {
            e.preventDefault();
            if (window.messageHandler) {
              window.messageHandler.show('すべての項目を入力してください。', 'error');
            } else {
              alert('すべての項目を入力してください。');
            }
            return;
          }
          
          // ローディング表示
          if (window.loadingHandler) {
            window.loadingHandler.show('シフト追加依頼を送信中...');
          } else {
            const submitButton = document.querySelector('button[type="submit"]');
            submitButton.disabled = true;
            submitButton.textContent = '送信中...';
          }
        });
      });
    </script>
  </body>
</html>
