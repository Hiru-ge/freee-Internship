<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <!-- CSSは外部ファイルに分離済み -->
  </head>
  <body>
    <div class="form-container"
         data-applicant-id="<%= @applicant_id %>"
         data-date="<%= @date %>"
         data-start-time="<%= @start_time %>"
         data-end-time="<%= @end_time %>"
         data-employees="<%= @employees.to_json.html_safe %>">
      <h1>シフト交代リクエスト</h1>

      <form id="request-form" action="<%= shift_exchanges_path %>" method="post">
        <%= hidden_field_tag :authenticity_token, form_authenticity_token %>

        <div class="form-group">
          <div class="form-row">
            <label for="applicant-display" class="form-label">申請者 (あなたの名前):</label>
            <input type="text" id="applicant-display" class="form-input readonly" value="<%= @employees.find { |emp| emp[:id] == @applicant_id }&.dig(:display_name) || '読み込み中...' %>" readonly>
            <input type="hidden" id="applicant-select" name="applicant_id" value="<%= @applicant_id %>">
          </div>
        </div>

        <div class="form-group">
          <div class="form-row">
            <label for="shift-date" class="form-label">交代したいシフトの日付:</label>
            <input type="date" id="shift-date" name="shift_date" class="form-input readonly" value="<%= @date %>" readonly required>
          </div>
        </div>

        <div class="form-group">
          <div class="form-row">
            <label class="form-label">交代したいシフトの時間:</label>
            <div class="time-inputs">
              <input type="time" id="start-time" name="start_time" class="form-input readonly" value="<%= @start_time %>" readonly required>
              <span class="time-separator">～</span>
              <input type="time" id="end-time" name="end_time" class="form-input readonly" value="<%= @end_time %>" readonly required>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">交代を依頼する相手を選択してください (複数選択可)</label>
          <div class="form-help">※ 複数の人に同時に依頼できます。誰か一人でも承認されれば交代が成立します。</div>
          <div id="employee-list" class="form-checkbox-group">
            <p>従業員を読み込んでいます...</p>
          </div>
        </div>

        <div class="form-buttons">
          <button type="submit" class="form-button">この内容でリクエストを送信</button>
          <a href="#" onclick="goBack(); return false;" class="form-button secondary">シフトページに戻る</a>
        </div>
      </form>
    </div>

    <%= javascript_include_tag 'shift_exchange' %>
  </body>
</html>
