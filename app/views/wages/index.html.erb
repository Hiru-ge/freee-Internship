<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>給与管理 - <%= @year %>年<%= @month %>月</title>
  <!-- CSSは外部ファイルに分離済み -->
</head>
<body>
  <div class="wages-container">
    <div class="wages-header">
      <h1>給与管理</h1>
      <h2><%= @year %>年<%= @month %>月</h2>
    </div>

    <div class="wages-navigation">
      <a href="<%= wages_path(year: @prev_year, month: @prev_month) %>" class="nav-button">← 前月</a>
      <a href="<%= wages_path(year: @next_year, month: @next_month) %>" class="nav-button">次月 →</a>
      <a href="<%= shifts_path %>" class="nav-button">シフトページに戻る</a>
    </div>

    <div class="wages-content">
      <h3>従業員別給与一覧</h3>

      <table class="wages-table">
        <thead>
          <tr>
            <th>従業員名</th>
            <th>勤務時間</th>
            <th>給与額</th>
            <th>目標達成率</th>
            <th>給与ゲージ</th>
          </tr>
        </thead>
        <tbody>
          <% @employee_wages.each do |wage_data| %>
            <tr>
              <td><%= wage_data[:employee_name] %></td>
              <td><%= wage_data[:work_hours].values.sum %>時間</td>
              <td class="wage-amount">¥<%= number_with_delimiter(wage_data[:wage]) %></td>
              <td class="wage-percentage <%= wage_data[:percentage] >= 100 ? 'high' : wage_data[:percentage] >= 80 ? 'medium' : 'low' %>">
                <%= wage_data[:percentage] %>%
              </td>
              <td>
                <div class="wage-gauge">
                  <div class="wage-gauge-fill <%= wage_data[:percentage] >= 100 ? 'high' : wage_data[:percentage] >= 80 ? 'medium' : 'low' %>"
                       style="width: <%= [wage_data[:percentage], 100].min %>%"></div>
                </div>
                <div class="gauge-text">
                  ¥<%= number_with_delimiter(wage_data[:wage]) %> / ¥<%= number_with_delimiter(wage_data[:target]) %>
                </div>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>

      <div class="wage-summary">
        <h3>月間サマリー</h3>
        <div class="summary-stats">
          <div class="stat-item">
            <div class="stat-value"><%= @employee_wages.size %></div>
            <div class="stat-label">従業員数</div>
          </div>
          <div class="stat-item">
            <div class="stat-value"><%= @total_hours %></div>
            <div class="stat-label">総勤務時間</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">¥<%= number_with_delimiter(@total_wage) %></div>
            <div class="stat-label">総給与額</div>
          </div>
          <div class="stat-item">
            <div class="stat-value"><%= @average_percentage %>%</div>
            <div class="stat-label">平均達成率</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
