<div class="container">
  <div class="login-container">
    <h1>勤怠管理システム</h1>
    <h2>パスワードを忘れた場合</h2>
    
    <div id="email-verification-section">
      <p>登録されているメールアドレスに認証コードを送信します。</p>
      
      <% if flash[:alert] %>
        <div class="message error">
          <%= flash[:alert] %>
        </div>
      <% end %>
      
      <% if flash[:notice] %>
        <div class="message success">
          <%= flash[:notice] %>
        </div>
      <% end %>
      
      <%= form_with url: forgot_password_auth_path, method: :post, local: true, id: "email-verification-form" do |form| %>
        <div class="form-group">
          <%= form.label :employee_id, "従業員を選択してください:" %>
          <%= form.select :employee_id, 
              options_for_select(@employees.map { |emp| [emp[:display_name], emp[:employee_id]] }, params[:employee_id]),
              { prompt: "-- 従業員を選択 --" },
              { required: true, id: "employee-select" } %>
        </div>
        
        <div class="form-actions">
          <%= form.submit "認証コードを送信", class: "button" %>
        </div>
      <% end %>
    </div>
    
    <div class="login-links">
      <%= link_to "ログイン画面に戻る", login_auth_path, class: "link" %>
    </div>
  </div>
</div>

<script>
  // ページ読み込み時の初期化
  document.addEventListener('DOMContentLoaded', function() {
    setupFormHandler();
  });
  
  function setupFormHandler() {
    const form = document.getElementById('email-verification-form');
    if (form) {
      form.addEventListener('submit', function(e) {
        const employeeSelect = document.getElementById('employee-select');
        
        if (!employeeSelect.value) {
          e.preventDefault();
          alert('従業員を選択してください。');
          employeeSelect.focus();
          return false;
        }
      });
    }
  }
</script>