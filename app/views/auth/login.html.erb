<div class="container">
  <div class="login-container">
    <h1>勤怠管理システム</h1>
    <h2>ログイン</h2>
    
    <%= form_with url: auth_login_path, method: :post, local: true, id: "login-form" do |form| %>
      <div class="form-group">
        <%= form.label :employee_id, "従業員を選択してください:" %>
        <%= form.select :employee_id, 
            options_for_select(@employees.map { |emp| [emp[:display_name], emp[:employee_id]] }, params[:employee_id]),
            { prompt: "-- 従業員を選択 --" },
            { required: true, id: "employee-select" } %>
      </div>
      
      <div class="form-group">
        <%= form.label :password, "パスワード:" %>
        <%= form.password_field :password, required: true, id: "password" %>
      </div>
      
      <div class="form-actions">
        <%= form.submit "ログイン", class: "button" %>
      </div>
    <% end %>
    
    <div class="login-links">
      <%= link_to "パスワードを忘れた場合", forgot_password_auth_path, class: "link" %>
      <%= link_to "初回パスワード設定", initial_password_auth_path, class: "link" %>
    </div>
    
    <% if flash[:alert] %>
      <div class="message error">
        <%= flash[:alert] %>
      </div>
    <% end %>
    
    <% if flash[:notice] %>
      <div class="message success">
        <%= flash[:notice] %>
      </div>
    <% end %>
  </div>
</div>

<script>
  // ページ読み込み時の初期化
  document.addEventListener('DOMContentLoaded', function() {
    setupFormHandler();
  });
  
  // フォームハンドラーの設定
  function setupFormHandler() {
    document.getElementById('login-form').addEventListener('submit', function(e) {
      var employeeId = document.getElementById('employee-select').value;
      var password = document.getElementById('password').value;
      
      if (!employeeId) {
        e.preventDefault();
        showMessage('従業員を選択してください', 'error');
        return;
      }
      
      if (!password) {
        e.preventDefault();
        showMessage('パスワードを入力してください', 'error');
        return;
      }
      
      // ログインボタンを無効化
      var submitButton = document.querySelector('button[type="submit"]');
      submitButton.disabled = true;
      submitButton.textContent = 'ログイン中...';
    });
  }
  
  // メッセージ表示
  function showMessage(message, type) {
    // 既存のメッセージを削除
    var existingMessage = document.querySelector('.message');
    if (existingMessage) {
      existingMessage.remove();
    }
    
    // 新しいメッセージを作成
    var messageDiv = document.createElement('div');
    messageDiv.className = 'message ' + type;
    messageDiv.textContent = message;
    
    // フォームの後に挿入
    var form = document.getElementById('login-form');
    form.parentNode.insertBefore(messageDiv, form.nextSibling);
  }
</script>