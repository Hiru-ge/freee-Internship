# 勤怠管理システム - タスク管理

## 概要
勤怠管理チェックアプリのタスク管理一覧です。
現在の基本機能は実装完了しており、以下の項目は今後の改善・拡張として管理しています。

## 🔴 緊急（Rails移行・既存機能完全移行）

### Rails移行 Phase 1: 基盤構築（最優先）
- [ ] Railsアプリケーションの作成
  - 新しいRails 7.0アプリケーションの作成
  - 必要なgemの設定（line-bot-api, dotenv-rails等）
  - 基本的なディレクトリ構造の構築
  - 見積時間: 30分

- [ ] 基本的なWebhookエンドポイントの実装
  - WebhookControllerの作成
  - LINE Bot SDKの設定
  - 基本的なメッセージ受信・応答機能
  - 見積時間: 30分

- [ ] Herokuへのデプロイ
  - Herokuアプリケーションの作成
  - 環境変数の設定
  - デプロイの実行
  - LINE Webhook URLの設定・検証
  - 見積時間: 1時間

### Rails移行 Phase 2: 既存機能完全移行（最重要）
- [ ] データベース設計・実装
  - PostgreSQLテーブル設計
  - モデル・リレーションの実装
  - 既存Google Sheetsデータの移行
  - 見積時間: 1時間

- [ ] 認証フローの完全移行
  - 既存の認証システムの完全移行
  - LINEユーザーと従業員IDの紐付け
  - 認証コード生成・検証機能
  - メール送信機能
  - 見積時間: 1.5時間

- [ ] シフト管理機能の完全移行
  - 既存のシフト確認機能の完全移行
  - 個人LINEでのシフト一覧表示
  - グループLINEでの全員シフト確認
  - 既存Google Sheets APIとの連携維持
  - 見積時間: 1時間

- [ ] 勤怠・給与管理機能の完全移行
  - 既存の勤怠状況確認機能の完全移行
  - 既存の給与状況確認機能（103万の壁ゲージ）の完全移行
  - freee API連携の維持
  - データ取得・表示機能の完全移行
  - 見積時間: 1時間

### Rails移行 Phase 3: 高度な機能実装
- [ ] シフト交代機能の実装
  - シフト交代依頼の送信
  - 交代承認・否認の処理
  - システムへの自動反映
  - 見積時間: 1時間

- [ ] 自動通知機能の実装
  - 打刻リマインダーの送信
  - 103万の壁アラート通知
  - シフト変更通知
  - 見積時間: 1時間

### LINE連携 Phase 2: 高度な機能
- [ ] 自動通知機能の実装
  - 打刻リマインダーの送信
  - 103万の壁アラート通知
  - シフト変更通知
  - 見積時間: 6時間

- [ ] 勤怠確認機能の実装
  - 個人LINEでの勤怠状況確認
  - 勤怠データの表示
  - 見積時間: 4時間

- [ ] 給与状況確認機能の実装
  - 103万の壁ゲージの状況表示
  - 給与情報の確認
  - 見積時間: 3時間

### LINE連携 Phase 3: 拡張機能
- [ ] 統計・レポート機能の実装
  - 勤怠統計の表示
  - 給与レポートの生成
  - 見積時間: 5時間

- [ ] カスタマイズ機能の実装
  - 通知設定のカスタマイズ
  - 表示設定の調整
  - 見積時間: 4時間

## 🟡 重要（セキュリティ・安定性）

### セッション有効期限の実装
- [ ] セッションタイムアウト機能の追加
  - 一定時間後の自動ログアウト機能
  - セキュリティ向上、不正アクセス防止
  - 見積時間: 4時間

### 入力値のサーバーサイドバリデーション
- [ ] 各API関数での入力値検証強化
  - サーバーサイドでの厳格な入力値検証
  - データ整合性確保、セキュリティ向上
  - 見積時間: 6時間

### 権限チェックの強化
- [ ] 全API関数での権限チェック追加
  - 各API呼び出しでの権限検証
  - 不正な権限昇格の防止
  - 見積時間: 3時間

## 🟢 通常（ユーザビリティ）

### エラーメッセージの統一
- [ ] 統一されたエラー表示システムの実装
  - `alert()`と`showMessage()`の統一
  - UX向上、一貫性の確保
  - 見積時間: 2時間

### ローディング状態の改善
- [ ] プログレスバー、詳細なローディング表示の実装
  - より詳細な進捗表示
  - ユーザビリティ向上
  - 見積時間: 3時間

### データの整合性チェック
- [ ] データ整合性チェック機能の実装
  - 重複データ、不正データの検出
  - データ品質向上
  - 見積時間: 4時間

## 🟢 通常（機能拡張）

### ログ機能の実装
- [ ] ログ記録システムの実装
  - 操作ログ、エラーログの記録
  - デバッグ支援、監査証跡
  - 見積時間: 5時間

### バックアップ・復旧機能
- [ ] 自動バックアップ機能の実装
  - データのバックアップ機能
  - データ保護、災害復旧
  - 見積時間: 6時間

## 完了済み機能 ✅

### 認証・セキュリティ機能
- [x] 認証設定画面の作成（パスワード変更画面に変更）
- [x] 認証設定シートの作成
- [x] パスワードハッシュ化機能の実装
- [x] ログイン認証機能の実装
- [x] セッション管理機能の実装（基本版）
- [x] 権限管理機能の実装
- [x] パスワードポリシーの実装
- [x] 既存画面への認証チェック機能の追加
- [x] ログアウト機能の実装

### UI・画面機能
- [x] ホーム画面に認証設定ボタンの追加
- [x] マイページトップ画面の作成
- [x] シフトページ画面の作成
- [x] ログイン後のリダイレクト先をマイページトップに変更
- [x] 不要になったホーム画面の削除
- [x] 認証設定画面をパスワード変更画面に変更
- [x] パスワード変更ページのログアウト機能修正

### パフォーマンス・最適化
- [x] オーナー用シフトページのローディング最適化
- [x] シフトリクエスト一覧の自動読み込み機能

### 仕様書・ドキュメント整備
- [x] 103万の壁ゲージ機能の実装完了状況を仕様書に反映
- [x] 打刻忘れアラート機能の仕様を正確に記載
- [x] 画面遷移図を実装に合わせて修正
- [x] 勤怠時刻修正機能の仕様を削除（今後の実装予定に移動）
- [x] LINE連携機能の詳細仕様書作成
- [x] LINE連携仕様書を別ファイル（line-integration.md）に分離
- [x] グループLINEと個人LINEの機能分離仕様の詳細化
- [x] LINE連携の認証・初期設定フローの詳細化
- [x] LINE連携のメッセージフォーマット・UI設計の詳細化
- [x] LINE連携のエラーハンドリング・例外処理の詳細化
- [x] LINE連携のデータ同期・整合性ルールの詳細化
- [x] 全員のシフト確認機能の仕様追加
- [x] 不要な機能（緊急連絡・店舗情報共有）の削除

### Rails移行準備・ドキュメント整備
- [x] TODOファイルの見直しと既存機能移行の優先順位調整
- [x] データベーススキーマ設計書の作成（既存機能完全移行のためのPostgreSQLスキーマ設計）
- [x] 残りのドキュメントをRails用に書き換え（仕様書、画面設計、LINE連携仕様、完全ガイドの作成）
- [x] 不要になったドキュメントの削除（clasp_setup.md、rails-migration-plan.md、rails-migration-technical-spec.md、rails-setup-guide.md）

## タスク管理情報

### 実装優先順位（既存機能完全移行を最優先）
1. 🔴 Rails移行 Phase 1: 基盤構築（最優先）
   - Railsアプリケーションの作成
   - 基本的なWebhookエンドポイントの実装
   - Herokuへのデプロイ
2. 🔴 Rails移行 Phase 2: 既存機能完全移行（最重要）
   - データベース設計・実装
   - 認証フローの完全移行
   - シフト管理機能の完全移行
   - 勤怠・給与管理機能の完全移行
3. 🔴 Rails移行 Phase 3: 高度な機能実装（緊急）
   - シフト交代機能の実装
   - 自動通知機能の実装
4. 🟡 セッション有効期限の実装（重要）
5. 🟡 入力値のサーバーサイドバリデーション（重要）
6. 🟡 権限チェックの強化（重要）
7. 🟢 エラーメッセージの統一（通常）
8. 🟢 ローディング状態の改善（通常）
9. 🟢 データの整合性チェック（通常）
10. 🟢 ログ機能の実装（通常）
11. 🟢 バックアップ・復旧機能（通常）

### 進捗状況
- **完了済み**: 基本機能、認証機能、UI機能、ドキュメント整備、Rails移行準備
- **最優先**: Rails移行・既存機能完全移行（今日中完遂）
- **次優先**: セキュリティ強化、ユーザビリティ改善
- **総見積時間**: 7時間（Rails移行: 7時間、その他: 33時間）

### 関連仕様
- 仕様書: `docs/requirement.md`（Rails版）
- 画面設計: `docs/screen-design.md`（Rails版）
- LINE連携仕様: `docs/line-integration.md`（Rails版）
- データベーススキーマ設計: `docs/database-schema-design.md`
- Rails移行完全ガイド: `docs/rails-migration-complete-guide.md`
- 103万ゲージ実装状況: `docs/103万ゲージ実装状況.md`

### 更新履歴
- 2024年: TODOファイルの構造化とタスク管理形式への変更
- 基本機能の実装完了
- ドキュメント整備完了
- Rails移行計画の策定（GASの制約により方針転換）
- Rails移行準備完了（データベース設計、ドキュメント整備、不要ファイル削除）
