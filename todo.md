# 勤怠管理システム - タスク管理

## 概要
勤怠管理チェックアプリのタスク管理一覧です。
現在の基本機能は実装完了しており、以下の項目は今後の改善・拡張として管理しています。

---

## ✅ 完了済みフェーズ

### Phase 9-0: LINE Bot接続テスト ✅ **完了**
**期間**: 完了済み
**優先度**: ✅ 完了

- [x] TDD実装（Red-Green-Refactor）
  - Redフェーズ: 失敗するテストの作成
  - Greenフェーズ: テストを通す最小限の実装
  - Refactorフェーズ: コードの品質向上とリファクタリング
  - 見積時間: 3時間
  - **技術要件**: t-wadaのTDDアプローチ
  - **成果**: 9テスト、23アサーション、すべて成功

- [x] LINE Bot基本機能実装
  - WebhookController: webhook受信とイベント処理
  - LineBotService: メッセージ処理のビジネスロジック
  - エラーハンドリング: 署名検証、メッセージ処理エラー
  - 見積時間: 4時間
  - **技術要件**: LINE Messaging API、責任の分離
  - **成果**: 堅牢で拡張可能なアーキテクチャ

- [x] ドキュメント整備
  - LINE Bot連携機能ドキュメント作成
  - デプロイ手順書作成
  - API仕様書作成
  - READMEファイル更新
  - 見積時間: 2時間
  - **技術要件**: 包括的なドキュメント整備
  - **成果**: 運用・保守に必要なドキュメント完備

### Phase 9-2.5: シフト交代承認・否認機能修正 ✅ **完了**
**期間**: 完了済み
**優先度**: ✅ 完了

- [x] TDD実装（Red-Green-Refactor）
  - Redフェーズ: 失敗するテストの作成
  - Greenフェーズ: テストを通す最小限の実装
  - Refactorフェーズ: コードの品質向上とリファクタリング
  - 見積時間: 4時間
  - **技術要件**: t-wadaのTDDアプローチ
  - **成果**: 5テスト、30アサーション、すべて成功

- [x] 外部キー制約エラーの解決
  - ActiveRecord::InvalidForeignKeyエラーの特定と解決
  - シフト削除前の関連データクリア処理の実装
  - 処理順序の最適化
  - 見積時間: 1時間
  - **技術要件**: データベース制約の適切な処理
  - **成果**: 安全なデータ操作の実現

- [x] 認証・権限チェックエラーの解決
  - ActiveModel::UnknownAttributeErrorの解決
  - NoMethodError: undefined method 'session'の解決
  - テストクラスの適切な継承
  - 見積時間: 1時間
  - **技術要件**: Railsテストフレームワークの適切な使用
  - **成果**: 堅牢なテストスイートの構築

- [x] エラーハンドリングの改善
  - ユーザーフレンドリーなエラーメッセージの実装
  - 適切なログ出力とデバッグ情報の追加
  - 権限チェックの強化
  - 見積時間: 1時間
  - **技術要件**: 統一されたエラーハンドリング
  - **成果**: 運用しやすいシステムの実現

- [x] ドキュメント整備
  - README.mdの更新
  - 実装状況レポートの更新
  - テスト仕様書の更新
  - API仕様書の更新
  - 実装詳細ドキュメントの更新
  - 見積時間: 1時間
  - **技術要件**: 包括的なドキュメント整備
  - **成果**: 保守性の向上と知識の共有

### Phase 1: Rails基盤構築 ✅ **完了**
**期間**: 完了済み
**優先度**: ✅ 完了

- [x] Railsアプリケーションの作成
  - 新しいRails 8.0.2アプリケーションの作成
  - 必要なgemの設定（line-bot-api, dotenv-rails等）
  - 基本的なディレクトリ構造の構築
  - 見積時間: 30分

- [x] 基本的なWebhookエンドポイントの実装
  - WebhookControllerの作成
  - LINE Bot SDKの設定
  - 基本的なメッセージ受信・応答機能
  - 見積時間: 30分

### Phase 2: 既存機能完全移行 ✅ **完了**
**期間**: 完了済み
**優先度**: ✅ 完了

#### Phase 2-1: 認証システム移行 ✅ **完了**
- [x] データベース設計・実装
  - employeesテーブル（認証情報のみ）
  - verification_codesテーブル（認証コード管理）
  - マイグレーション実行
  - 見積時間: 30分

- [x] 認証システムの完全移行
  - ログイン画面（view_login.html → app/views/auth/login.html.erb）
  - 初回パスワード設定（view_initial_password.html → app/views/auth/initial_password.html.erb）
  - パスワード変更（view_password_change.html → app/views/auth/password_change.html.erb）
  - パスワード忘れ（view_forgot_password.html → app/views/auth/forgot_password.html.erb）
  - 見積時間: 2時間

- [x] freee API連携の実装
  - FreeeApiService（code-api.js → app/services/freee_api_service.rb）
  - 認証サービス（code-auth.js → app/services/auth_service.rb）
  - 従業員情報の動的取得
  - 実データでのDB再構築
  - 見積時間: 1.5時間

- [x] メール送信機能の実装
  - AuthMailer（Gmail SMTP連携）
  - **注意**: RenderではSMTPポートがブロックされているため、Fly.io移行が必要
  - 認証コード送信機能
  - パスワードリセット機能
  - 見積時間: 1時間

- [x] 環境変数への移行
  - 機密情報の.envファイル分離
  - セキュリティ向上
  - 見積時間: 30分

- [x] 認証機能のテスト・コミット
  - ログイン機能の動作確認
  - パスワード変更機能の動作確認
  - freee API連携の動作確認
  - セッション管理の動作確認
  - コミット: "feat: 認証システムの完全移行"
  - 見積時間: 30分

#### Phase 2-2: マイページ機能移行 ✅ **完了**
- [x] マイページ機能の完全移行
  - マイページトップ（view_my_page.html → app/views/dashboard/index.html.erb）
  - 打刻機能（code-clock.js → app/services/clock_service.rb）
  - 勤怠履歴表示
  - 月次ナビゲーション
  - 見積時間: 2時間

- [x] マイページ機能のテスト・コミット
  - 打刻機能の動作確認
  - 勤怠履歴の表示確認
  - コミット: "feat: マイページ・打刻機能の完全移行"
  - 見積時間: 30分

#### Phase 2-3: シフト管理機能移行 ✅ **完了**
- [x] シフト管理機能の完全移行
  - シフトページ（view_shift_page.html → app/views/shifts/index.html.erb）
  - シフト表示・確認機能
  - 月次ナビゲーション
  - 見積時間: 1.5時間

- [x] シフト情報のDB取り込み
  - Shiftモデルの作成
  - マイグレーション実行
  - GASテストデータの移植（81件）
  - 見積時間: 1時間

- [x] freee API連携によるシフトデータ取得
  - FreeeApiService#get_employees実装
  - ShiftsController#data実装
  - 従業員情報とシフトデータの統合
  - 見積時間: 1時間

- [x] 103万の壁ゲージのHTML枠作成
  - オーナー向け給与ゲージセクション
  - 従業員向け個人ゲージセクション
  - 実装予定表示
  - 見積時間: 0.5時間

- [x] シフト管理機能のテスト・コミット
  - シフト表示の動作確認
  - ナビゲーションの動作確認
  - GAS版との整合性確認
  - コミット: "feat: シフト管理機能の完全移行"
  - 見積時間: 30分

#### Phase 2-4: シフト交代機能移行 ✅ **完了**
- [x] シフト交代機能の完全移行
  - シフト交代リクエスト（view_shift_request_form.html → app/views/shifts/request.html.erb）
  - シフト交代承認（view_shift_approval.html → app/views/shifts/approval.html.erb）
  - シフト追加依頼（view_shift_add_form.html → app/views/shifts/add.html.erb）
  - 見積時間: 2.5時間

- [x] シフト交代機能のテスト・コミット
  - リクエスト送信の動作確認
  - 承認・否認の動作確認
  - メール通知機能の実装
  - シフト重複チェック機能の実装
  - API互換性（GAS互換）の実装
  - コミット: "feat: シフト交代機能の完全移行"
  - 見積時間: 30分

#### Phase 2-5: 給与管理機能移行 ✅ **完了**
- [x] 給与管理機能の完全移行
  - 103万の壁ゲージ（code-wage.js → app/services/wage_service.rb）
  - 給与計算・表示機能
  - 時間帯別時給システム
  - 見積時間: 2時間

- [x] 給与管理機能のテスト・コミット
  - 給与計算の動作確認
  - ゲージ表示の動作確認
  - 給与一覧画面の実装
  - ダッシュボード・シフトページ統合
  - シフトページデザイン統一（ダークテーマ）
  - 個人給与詳細ページ削除（GASに存在しないため）
  - コミット: "feat: 給与管理機能の完全移行"
  - 見積時間: 30分

### Phase 3: 統合・最適化 ✅ **完了**
**期間**: 完了済み
**優先度**: ✅ 完了

#### Phase 3-1: UI・UX統一 ✅ **完了**
- [x] CSS・デザイン統一
  - css.html → app/assets/stylesheets/application.css
  - 全画面のデザイン統一
  - レスポンシブ対応
  - 見積時間: 1時間

- [x] エラーハンドリング統一
  - 統一されたエラー表示システム
  - エラーメッセージの標準化
  - 見積時間: 1時間

- [x] ローディング状態改善
  - プログレスバー、詳細なローディング表示
  - ユーザビリティ向上
  - 見積時間: 1時間

#### Phase 3-2: バックグラウンド処理 ✅ **完了**
- [x] 自動通知機能の実装（メール通知）
  - 打刻リマインダーの送信（ClockReminderService、ClockReminderJob）
  - シフト変更通知（ShiftMailer、EmailNotificationService）
  - 認証関連通知（AuthMailer）
  - 見積時間: 2時間

### Phase 4: UX改善・ユーザビリティ向上 ✅ **完了**
**期間**: 完了済み
**優先度**: ✅ 完了

#### Phase 4-1: UX改善実装 ✅ **完了**
- [x] 自分のシフト以外をクリックできないようにする
  - シフト表で自分のシフトのみクリック可能にする
  - 他人のシフトは視覚的にクリック不可であることを示す
  - 見積時間: 1時間

- [x] シフト交換依頼時の依頼元変更制限
  - 申請者フィールドを読み取り専用にして変更不可にする
  - 依頼元は必ず自分なので変更できないようにする
  - 見積時間: 0.5時間

- [x] 全ユーザー表示時のIDソート
  - 従業員一覧をID順でソートして表示する
  - シフト交換依頼フォームの従業員選択でもID順ソート
  - 見積時間: 0.5時間

- [x] 各所の文言修正
  - より分かりやすい文言に変更する
  - ユーザーにとって理解しやすい表現に統一
  - 見積時間: 1時間

- [x] トースト形式のメッセージ表示
  - エラーや成功時のメッセージをトースト形式で表示する
  - 既存のMessageHandlerを活用して統一感を保つ
  - 見積時間: 1.5時間

- [x] 詳細なエラー文言
  - エラーメッセージをより具体的で分かりやすくする
  - ユーザーが対処しやすい情報を提供
  - 見積時間: 1時間

#### Phase 4-2: 追加UX改善 ✅ **完了**
- [x] 文言の不整合修正
  - 「ホーム画面」を「シフトページ」に統一
  - 戻るボタンの文言を実際の遷移先と一致させる
  - 見積時間: 1時間

- [x] 残りのalertをトースト形式に変更
  - 各ビューファイルのalert呼び出しをwindow.messageHandler.showに置換
  - フォールバック機能の実装
  - 見積時間: 1時間

- [x] 複数人へのシフト交代リクエストで部分成功時の詳細メッセージ実装
  - ShiftOverlapServiceにget_available_and_overlapping_employeesメソッド追加
  - 利用可能な従業員のみにリクエスト送信
  - 重複している従業員の名前を含む詳細な成功メッセージ
  - 見積時間: 1.5時間

- [x] JavaScriptエラーの修正とフラッシュメッセージ表示の改善
  - 変数名の重複エラー修正（style → messageStyle, loadingStyle）
  - DOM要素の存在チェック追加
  - 初期化タイミングの改善
  - エラーハンドリングの強化
  - 見積時間: 1.5時間

#### Phase 4-3: 残存課題の解決 ✅ **完了**
- [x] フラッシュメッセージ表示の完全修正 ✅ **完了**
  - 課題: シフト交代リクエストの部分成功メッセージがトースト通知で正しく表示されない
  - 現状: 部分成功メッセージは正常に表示されることを確認
  - 見積時間: 1.5時間
  - 優先度: 高

### Phase 5: UI/UX改善・情報設計最適化 ✅ **完了**
**期間**: 完了済み
**優先度**: ✅ 完了

#### Phase 5-1: ダッシュボード簡素化 ✅ **完了**
- [x] ダッシュボードビューの更新
  - [x] 103万の壁ゲージセクションを削除
  - [x] 月別勤怠履歴を今月の履歴のみに変更
  - [x] 打刻ボタンのデザイン改善
  - [x] ナビゲーションをクイックアクセスに変更

- [x] コントローラーの更新
  - [x] DashboardControllerの修正
  - [x] 給与情報の取得処理を削除
  - [x] 今月の勤怠履歴取得処理を追加

- [x] スタイリングの更新
  - [x] ダッシュボード専用CSSの作成
  - [x] 打刻ボタンの強調スタイル
  - [x] 今月の勤怠履歴の表示スタイル
  - [x] クイックアクセスのスタイル

#### Phase 5-2: ヘッダーナビゲーション導入 ✅ **完了**
- [x] ヘッダーコンポーネントの作成
  - [x] app/views/shared/_header.html.erbの作成
  - [x] ロゴとブランド名の表示
  - [x] ナビゲーションメニューの実装
  - [x] 権限管理による表示制御
  - [x] アクティブ状態の管理
  - [x] 現在ログインしているユーザー情報の表示

- [x] レイアウトファイルの更新
  - [x] app/views/layouts/application.html.erbの更新
  - [x] ヘッダーコンポーネントの読み込み
  - [x] 既存のナビゲーション削除
  - [x] メタタグとSEO設定の確認

- [x] JavaScript機能の実装
  - [x] モバイルメニューの動作
  - [x] ハンバーガーメニューの開閉
  - [x] メニュー外クリックでの自動クローズ
  - [x] アクティブ状態の管理

- [x] 権限管理の実装
  - [x] オーナー権限の表示制御
  - [x] 給与メニューの表示/非表示
  - [x] 管理機能へのアクセス制御
  - [x] セキュリティの確認

#### Phase 5-3: 情報再配置と新規ページ ✅ **完了**
- [x] シフトページへの給与ゲージ統合
  - [x] シフトページビューの更新
  - [x] オーナー向け：全従業員の給与状況一覧
  - [x] 従業員向け：個人の給与ゲージ
  - [x] 既存のシフト表との統合

- [x] 勤怠履歴機能の統合
  - [x] ダッシュボードでの月別勤怠履歴表示
  - [x] ページネーション機能の復活
  - [x] 前月/次月ナビゲーション
  - [x] 勤怠履歴テーブル表示

- [x] 設定ページの統合
  - [x] 既存コントローラーの活用
  - [x] AuthControllerのpassword_changeアクションを拡張
  - [x] アカウント情報の表示機能追加
  - [x] その他の設定項目の追加

#### Phase 5-4: UX改善とテスト ✅ **完了**
- [x] アクセシビリティの向上
  - [x] WCAG 2.1 AA準拠の確認
  - [x] キーボードナビゲーション対応
  - [x] スクリーンリーダー対応
  - [x] 色のコントラスト比の確認
  - [x] フォーカス表示の改善

- [x] ユーザビリティテストの実施
  - [x] テスト計画の作成
  - [x] テストシナリオの定義
  - [x] テストユーザーの選定
  - [x] 評価指標の設定

- [x] パフォーマンス最適化
  - [x] ページ読み込み速度の改善
  - [x] 画像の最適化
  - [x] CSS/JavaScriptの圧縮
  - [x] キャッシュの設定

- [x] バグ修正と微調整
  - [x] 既知の問題の修正
  - [x] レイアウトの崩れ修正
  - [x] JavaScriptエラーの修正
  - [x] レスポンシブ表示の調整

---

## 🔴 デプロイ前必須（未完了）

### Phase 6: セキュリティ強化（デプロイ前必須）
**期間**: 1-2週間
**優先度**: 🔴 最高

#### Phase 6-1: セッション管理の強化 ✅ **完了**
- [x] セッションタイムアウト機能の実装
  - 一定時間後の自動ログアウト機能（24時間）
  - セッション有効期限の設定
  - セキュリティ向上、不正アクセス防止
  - 見積時間: 4時間
  - **影響**: セキュリティリスクの高い永続セッションを修正
  - **実装完了**: 2025年1月（TDD手法で実装）

- [x] CSRF保護の強化
  - Content Security Policyの有効化
  - CSRFトークンの検証強化
  - セキュリティヘッダーの設定
  - 見積時間: 3時間
  - **影響**: クロスサイトリクエストフォージェリ攻撃の防止
  - **実装完了**: 2025年1月（TDD手法で実装）

#### Phase 6-2: 入力値検証の強化 🔴 **必須**
- [x] サーバーサイドバリデーションの実装
  - 全API関数での厳格な入力値検証
  - SQLインジェクション対策
  - XSS対策の強化
  - データ整合性確保、セキュリティ向上
  - 見積時間: 6時間
  - **影響**: 不正な入力値による攻撃の防止

- [x] 権限チェックの強化
  - 全API関数での権限検証
  - 不正な権限昇格の防止
  - アクセス制御の厳格化
  - 見積時間: 4時間
  - **影響**: 権限昇格攻撃の防止

#### Phase 6-3: データベースセキュリティ ✅ **完了**
- [x] 外部キー制約の追加
  - データ整合性を保証する外部キー制約の設定
  - 参照整合性の確保
  - 見積時間: 3時間
  - **影響**: データ整合性の保証
  - **実装完了**: 2025年1月（TDD手法で実装）

- [x] データベースインデックスの最適化
  - 検索頻度の高いカラムへのインデックス追加
  - パフォーマンス向上
  - 見積時間: 2時間
  - **影響**: クエリパフォーマンスの向上
  - **実装完了**: 2025年1月（TDD手法で実装）

### Phase 7: 機能修正・安定性向上（デプロイ前必須）
**期間**: 1週間
**優先度**: 🔴 高

#### Phase 7-1: 既知の機能不具合修正 ✅ **完了**
- [x] エラーハンドリングの統一と改善 ✅ **完了**
  - 全画面でのエラーメッセージ表示の一貫性確保
  - ユーザーフレンドリーなエラーメッセージの実装
  - エラー発生時の適切なフォールバック処理
  - 見積時間: 3時間
  - 優先度: 高
  - **影響**: ユーザビリティの向上とエラー対応の改善
  - **実装完了**: 2025年1月（TDD手法で実装）
  - **成果**: ErrorHandlerモジュール作成、統一されたエラーメッセージ、セキュリティ向上

#### Phase 7-2: パフォーマンス最適化 ✅ **完了**
- [x] N+1問題の解決
  - find_byの多用によるパフォーマンス問題の修正
  - includes/joinsの適切な使用
  - データベースクエリの最適化
  - 見積時間: 4時間
  - **影響**: レスポンス時間の大幅改善
  - **実装完了**: 2025年1月（TDD手法で実装）

- [x] freee API呼び出しの最適化
  - 重複呼び出しの削減
  - キャッシュ戦略の実装
  - API呼び出し頻度の制限
  - 見積時間: 3時間
  - **影響**: 外部API依存の最適化とコスト削減
  - **実装完了**: 2025年1月（TDD手法で実装）

#### Phase 7-3: ログ・監査機能の実装 ❌ **スキップ**
- [x] ~~ログ機能の実装~~ **スキップ理由**: 短期的使用アプリケーションのため投資対効果が低い
  - ~~操作ログ、エラーログの記録~~
  - ~~デバッグ支援、監査証跡~~
  - ~~セキュリティログの実装~~
  - ~~見積時間: 4時間~~
  - ~~**影響**: 運用監視とセキュリティ監査の実現~~

### Phase 8: 本番環境構築・デプロイ ✅ **完了**
**期間**: 完了済み
**優先度**: ✅ 完了
**注意**: Phase 7-3と8-4をスキップし、8-1と8-2に集中して完了

#### Phase 8-1: 本番環境設定 ✅ **完了**
- [x] 本番環境設定の完了 ✅ **完了**
  - 環境変数の最終確認と設定
  - SSL設定の確認
  - メール設定の最終確認
  - セキュリティ設定の適用
  - 見積時間: 3時間
  - **影響**: 本番環境での安全な運用
  - **実装完了**: 2025年9月14日

- [x] データベース本番環境準備 ✅ **完了**
  - 本番データベースの設定
  - マイグレーションの実行
  - 初期データの投入
  - バックアップ設定
  - 見積時間: 2時間
  - **影響**: 本番データの安全な管理
  - **実装完了**: 2025年9月14日

#### Phase 8-2: デプロイ・検証 ✅ **完了**
- [x] Fly.ioへのデプロイ ✅ **完了**
  - Fly.ioアプリケーションの作成
  - 環境変数の設定
  - デプロイの実行
  - アプリケーション再作成手順の確立
  - 見積時間: 2時間
  - **影響**: 本番環境への安全なデプロイ
  - **実装完了**: 2025年9月14日

- [x] 本番環境での動作確認 ✅ **完了**
  - 全機能の動作確認
  - パフォーマンステスト
  - エラーハンドリングの確認
  - セキュリティテスト
  - 負荷テスト
  - 見積時間: 4時間
  - **影響**: 本番運用開始前の最終検証
  - **実装完了**: 2025年9月14日

#### Phase 8-3: Fly.io移行 ✅ **完了**
- [x] **RenderからFly.ioへの移行** ✅ **完了**
  - 現状: RenderでSMTPポートがブロックされているためメール送信が動作しない
  - 原因: Renderのインフラ制限（SMTPポート25, 587, 465をブロック）
  - 対応: Fly.ioへの移行（SMTPポート制限なし）
  - 見積時間: 3時間
  - **影響**: メール通知機能の復旧とGmail SMTPの使用可能
  - **実装完了**: 2025年9月14日

- [x] Fly.io CLIのインストール・設定 ✅ **完了**
  - Fly.io CLIのインストール
  - アカウント作成・ログイン
  - アプリケーションの初期化
  - 見積時間: 0.5時間
  - **影響**: Fly.io環境の準備
  - **実装完了**: 2025年9月14日

- [x] データベースの移行 ✅ **完了**
  - SQLiteデータベースの使用（無料枠対応）
  - データの移行
  - 接続設定の更新
  - 見積時間: 1時間
  - **影響**: データの安全な移行
  - **実装完了**: 2025年9月14日

- [x] 環境変数の移行 ✅ **完了**
  - Fly.io CLIで環境変数の設定
  - Gmail SMTP設定の確認
  - その他必要な環境変数の設定
  - 見積時間: 0.5時間
  - **影響**: 設定の移行
  - **実装完了**: 2025年9月14日

- [x] デプロイ・テスト ✅ **完了**
  - Fly.ioへのデプロイ
  - 本番環境での動作確認
  - メール送信機能のテスト
  - 見積時間: 1時間
  - **影響**: 本番環境での動作確認
  - **実装完了**: 2025年9月14日

- [x] アプリケーション再作成手順の確立 ✅ **完了**
  - デプロイ時の「failed to get lease on VM」エラー対応
  - アプリケーション削除・再作成の手順確立
  - 環境変数再設定の自動化
  - 見積時間: 1時間
  - **影響**: デプロイ問題の根本的解決
  - **実装完了**: 2025年9月14日

#### Phase 8-4: 運用準備 ❌ **スキップ**
- [x] ~~監視・アラート設定~~ **スキップ理由**: 時間的制約と短期的使用のため
  - ~~アプリケーション監視の設定~~
  - ~~エラーアラートの設定~~
  - ~~パフォーマンス監視の設定~~
  - ~~見積時間: 2時間~~
  - ~~**影響**: 本番運用時の問題早期発見~~

- [x] ~~ドキュメント整備~~ **スキップ理由**: 時間的制約と短期的使用のため
  - ~~運用マニュアルの作成~~
  - ~~障害対応手順書の作成~~
  - ~~バックアップ・復旧手順書の作成~~
  - ~~見積時間: 3時間~~
  - ~~**影響**: 運用チームの効率的な運用支援~~

---

## 🚀 次のステップ

### 本番環境デプロイ準備
**期間**: 即座に実行可能
**優先度**: 🔴 緊急

- [ ] 環境変数設定
  - LINE_CHANNEL_SECRETの設定
  - LINE_CHANNEL_TOKENの設定
  - 見積時間: 30分
  - **技術要件**: Fly.io secrets設定
  - **依存関係**: LINE Developer Consoleでの認証情報取得

- [ ] LINE Developer Console設定
  - Webhook URL設定: `https://your-app.fly.dev/webhook/callback`
  - Webhook検証の実行
  - 見積時間: 30分
  - **技術要件**: LINE Developer Console操作
  - **依存関係**: 本番環境のデプロイ完了

- [ ] 本番環境デプロイ
  - `fly deploy`の実行
  - デプロイ状況の確認
  - ログの確認
  - 見積時間: 30分
  - **技術要件**: Fly.io CLI
  - **依存関係**: 環境変数設定完了

- [ ] 動作確認
  - LINE Bot友達追加テスト
  - ヘルプコマンドテスト
  - エラーハンドリングテスト
  - 見積時間: 30分
  - **技術要件**: 実際のLINEアカウント
  - **依存関係**: 本番環境デプロイ完了

## 🟢 将来の拡張（デプロイ後）

### Phase 9: LINE連携機能実装
**期間**: デプロイ後
**優先度**: 🟢 通常

#### Phase 9-0: LINE Bot接続テスト ✅ **完了**
**期間**: 完了済み
**優先度**: ✅ 完了

- [x] LINE Bot接続テストの実装
  - LINE Botアカウントの作成・設定
  - Webhookエンドポイントの設定
  - 基本的なメッセージ送受信テスト
  - グループ・個人の識別テスト
  - 見積時間: 3時間
  - **技術要件**: LINE Messaging API、ngrok（ローカル開発用）
  - **依存関係**: 既存のWebhookControllerの基本機能

- [x] 環境設定の確認
  - LINE_CHANNEL_SECRET、LINE_CHANNEL_TOKENの設定確認
  - 本番環境でのWebhook URL設定
  - SSL証明書の確認（本番環境）
  - 見積時間: 2時間
  - **技術要件**: Fly.io環境でのSSL設定確認
  - **依存関係**: 本番環境のデプロイ完了

- [x] 接続テストの実行
  - 個人LINEでのメッセージ送受信テスト
  - グループLINEでのメッセージ送受信テスト
  - エラーハンドリングのテスト
  - 見積時間: 2時間
  - **技術要件**: 実際のLINEアカウントでのテスト
  - **依存関係**: LINE Bot接続テストの実装完了

- [x] TDD実装（Red-Green-Refactor）
  - Redフェーズ: 失敗するテストの作成
  - Greenフェーズ: テストを通す最小限の実装
  - Refactorフェーズ: コードの品質向上とリファクタリング
  - 見積時間: 3時間
  - **技術要件**: t-wadaのTDDアプローチ
  - **成果**: 9テスト、23アサーション、すべて成功

- [x] ドキュメント整備
  - LINE Bot連携機能ドキュメント作成
  - デプロイ手順書作成
  - API仕様書作成
  - READMEファイル更新
  - 見積時間: 2時間
  - **技術要件**: 包括的なドキュメント整備
  - **成果**: 運用・保守に必要なドキュメント完備

#### Phase 9-1: LINE Bot基盤強化（1-2週間）
**期間**: 1-2週間
**優先度**: 🟢 通常

- [x] LINE Bot基盤の拡張 ✅ **完了**
  - [x] グループ・個人の識別機能の実装
  - [x] 従業員IDとLINEアカウントの紐付け機能
  - [x] 基本的なコマンド処理の拡張
  - 見積時間: 4時間
  - **技術要件**: LINE APIの`source.type`でグループ・個人判定
  - **依存関係**: Phase 9-0の接続テスト完了
  - **実装完了**: 2025年1月（TDD手法で実装）
  - **成果**: 14テスト、31アサーション、すべて成功

- [x] 認証システムの拡張 ✅ **完了**
  - [x] 従業員ID入力機能の実装
  - [x] メール認証コード送信機能の統合
  - [x] LINEアカウントとの紐付け機能
  - 見積時間: 3時間
  - **技術要件**: 既存の認証システム（AuthService）を活用
  - **依存関係**: 既存のメール認証コード機能
  - **実装完了**: 2025年1月（TDD手法で実装）
  - **成果**: 認証関連機能の基盤実装完了

- [x] データベース設計・実装 ✅ **完了**
  - [x] Employeeテーブルにline_idカラムを追加
  - [x] LineMessageLogモデルの作成
  - [x] マイグレーションの実行
  - 見積時間: 2時間
  - **技術要件**: SQLite3でのテーブル設計
  - **依存関係**: 既存のEmployeeモデルとの関連付け
  - **設計変更**: EmployeeLineAccountテーブル → Employeeテーブルへのline_id追加
  - **実装完了**: 2025年1月（TDD手法で実装）
  - **成果**: データベース設計完了、2つのマイグレーション実行

#### Phase 9-2: 基本機能実装 ✅ **完了**
**期間**: 完了済み
**優先度**: ✅ 完了

- [x] シフト確認機能の実装 ✅ **完了**
  - 個人シフト確認機能（認証必要）
  - 全従業員シフト確認機能（認証必要）
  - グループ・個人チャット両対応
  - 見積時間: 5時間
  - **技術要件**: 既存のShiftモデル・ShiftsControllerを活用
  - **依存関係**: Phase 9-1の認証システム
  - **実装完了**: 2025年1月（TDD手法で実装）
  - **成果**: 認証チェック付きシフト確認機能

- [x] 認証コマンドの実装 ✅ **完了**
  - 従業員名入力による認証機能
  - 会話状態管理システム（ConversationStateモデル）
  - 複数ターンにまたがる認証フロー
  - 従業員検索機能（部分一致・完全一致）
  - 複数マッチ時の選択肢提示
  - 認証コードメール送信機能
  - 見積時間: 6時間
  - **技術要件**: ConversationStateモデル、会話状態管理
  - **依存関係**: Phase 9-1の認証システム
  - **実装完了**: 2025年1月（TDD手法で実装）
  - **成果**: セキュアな多段階認証システム

- [x] コマンド処理システムの実装 ✅ **完了**
  - 実装済みコマンド:
    - ヘルプ/help: 利用可能なコマンド表示（コンテキスト対応）
    - 認証: 従業員名入力による認証コード生成・LINEアカウント紐付け（個人チャットのみ）
    - シフト: 個人のシフト確認（認証必要）
    - 全員シフト: 全従業員のシフト確認（認証必要、グループ・個人両対応）
    - シフト交代: シフト交代依頼・承認（グループチャットのみ）
    - シフト追加: シフト追加依頼・承認（グループチャットのみ）
  - セキュリティ機能:
    - 認証チェック機能
    - グループ・個人チャットの適切な分離
    - エラーハンドリング機能
  - 見積時間: 4時間
  - **技術要件**: 既存のWebhookControllerの拡張
  - **依存関係**: Phase 9-1の基盤機能
  - **実装完了**: 2025年1月（TDD手法で実装）
  - **成果**: セキュアで使いやすいコマンドシステム

- [x] シフト交代機能の実装 ✅ **完了**
  - シフト交代依頼機能（Flex Message形式のシフトカード表示）
  - 承認・否認機能（Flex Message形式の承認待ちリクエスト表示）
  - 承認状況確認機能
  - 承認後の通知機能
  - 見積時間: 6時間
  - **技術要件**: 既存のShiftExchangeモデルを拡張、Flex Message使用
  - **依存関係**: 既存のシフト交代システムとの統合
  - **実装完了**: 2025年1月（TDD手法で実装）
  - **成果**: 美しいUIと直感的な操作のシフト交代システム

- [x] コマンド処理システムの実装 ✅ **完了**
  - 実装済みコマンド:
    - ヘルプ/help: 利用可能なコマンド表示
    - 認証: 認証コード生成・LINEアカウント紐付け
    - シフト: 個人のシフト確認
    - 全員シフト: グループ全体のシフト確認
    - シフト交代: シフト交代依頼・承認
    - シフト追加: シフト追加依頼・承認
  - エラーハンドリング機能
  - 見積時間: 4時間
  - **技術要件**: 既存のWebhookControllerの拡張
  - **依存関係**: Phase 9-1の基盤機能
  - **実装完了**: 2025年1月（TDD手法で実装）
  - **成果**: シフト確認機能・認証機能と統合して実装完了
  - **テスト**: 32テスト、60アサーション、すべて成功

#### Phase 9-2.5: 緊急不具合修正 ✅ **完了**
**期間**: 完了済み
**優先度**: ✅ 完了

- [x] Webアプリ上でのシフト交代リクエスト承認・否認機能の修正
  - Webアプリ上から交代リクエストを承認・否認しても何も起きない(リクエストも削除されなければシフト変更も起きない)
  - 承認・否認後のリクエスト削除処理の修正
  - 承認後のシフト変更処理の修正
  - 否認後の適切な処理の実装
  - 見積時間: 4時間
  - **技術要件**: TDD手法による包括的テストスイート作成
  - **依存関係**: 既存のシフト交代システム
  - **実装完了**: 2025年1月
  - **成果**: 外部キー制約エラー、認証エラー、権限チェックエラーの解決
  - **テスト**: 5テスト、30アサーション、すべて成功

- [ ] 打刻機能のタイムゾーンずれ修正
  - タイムゾーン設定の確認・修正
  - 打刻時刻の正確な記録
  - 表示時刻の修正
  - 見積時間: 3時間
  - **技術要件**: Railsのタイムゾーン設定、Time.zoneの適切な使用
  - **依存関係**: 既存の打刻機能
  - **緊急度**: 🔴 最高（既存機能の不具合）

#### Phase 9-3: シフト追加リクエスト機能実装 🔄 **進行中**
**期間**: 1-2週間
**優先度**: 🟡 重要

- [ ] シフト追加リクエストフローの設計
  - 日付選択→時間入力→対象従業員選択→確認→送信のフロー設計
  - 会話状態管理の設計
  - エラーハンドリングの設計
  - 見積時間: 2時間
  - **技術要件**: 既存のシフト交代フローを参考にした設計
  - **依存関係**: Phase 9-2の基本機能

- [ ] シフト追加リクエスト用のFlex Message作成
  - 日付選択UI
  - 時間入力UI
  - 従業員選択UI
  - 確認UI
  - 見積時間: 3時間
  - **技術要件**: LINE Messaging APIのFlex Message
  - **依存関係**: フロー設計の完了

- [ ] シフト追加リクエスト機能の実装
  - LineBotServiceの拡張
  - 会話状態管理の実装
  - メッセージ処理の実装
  - 見積時間: 4時間
  - **技術要件**: 既存のシフト交代機能と同様の実装
  - **依存関係**: Flex Message作成の完了

- [ ] 既存のシフト追加承認機能との統合
  - メール通知の統合
  - 承認フローの統合
  - データベース連携の確認
  - 見積時間: 2時間
  - **技術要件**: 既存のShiftAdditionモデルとの連携
  - **依存関係**: 機能実装の完了

- [ ] テスト作成（TDD手法）
  - 単体テストの作成
  - 統合テストの作成
  - エラーテストの作成
  - 見積時間: 3時間
  - **技術要件**: Railsのテストフレームワーク
  - **依存関係**: 機能実装の完了

#### Phase 9-4: 高度な機能実装（将来予定）
**期間**: 2-3週間
**優先度**: 🟢 通常

- [ ] 通知機能の実装
  - 打刻リマインダー機能
  - シフト変更通知機能
  - 見積時間: 5時間
  - **技術要件**: Railsのバックグラウンドジョブ（SolidQueue）を活用
  - **依存関係**: 既存の通知システムとの統合

- [ ] メッセージフォーマット・UI設計の実装
  - シフト確認メッセージの改善
  - 全員シフト確認メッセージの改善
  - 見積時間: 3時間
  - **技術要件**: LINE Messaging APIのテキスト・クイックリプライ機能
  - **依存関係**: Phase 9-3のシフト追加機能

#### Phase 9-5: 統合・テスト（1週間）
**期間**: 1週間
**優先度**: 🟢 通常

- [ ] 統合テストの実装
  - グループLINE機能のテスト
  - 個人LINE機能のテスト
  - シフト交代フローのテスト
  - シフト追加フローのテスト
  - 見積時間: 4時間
  - **技術要件**: Railsのテストフレームワークを活用
  - **依存関係**: Phase 9-3のシフト追加機能実装完了

- [ ] エラーハンドリング・例外処理の実装
  - システムエラー時の対応
  - システム障害時の対応
  - 不正コマンド時の対応
  - 見積時間: 3時間
  - **技術要件**: 既存のErrorHandlerモジュールを活用
  - **依存関係**: Phase 9-3のシフト追加機能

- [ ] パフォーマンス最適化
  - データ同期ルールの実装
  - キャッシュ戦略の実装
  - API呼び出し最適化
  - 見積時間: 3時間
  - **技術要件**: 既存の最適化機能を活用
  - **依存関係**: 全機能の実装完了

#### Phase 9-6: 運用準備（1週間）
**期間**: 1週間
**優先度**: 🟢 通常

- [ ] 初期設定フローの実装
  - 店舗のグループLINEにBotを追加する手順
  - 各従業員が個人LINEでBotを友達追加する手順
  - 従業員IDとLINEアカウントの紐付け手順
  - 見積時間: 2時間
  - **技術要件**: ドキュメント整備とユーザーガイド作成
  - **依存関係**: 全機能の実装完了

- [ ] 日常運用フローの確立
  - グループLINEでのシフト交代連携手順
  - グループLINEでのシフト追加依頼手順
  - 個人LINEでのシフト確認手順
  - 自動通知による情報共有手順
  - 見積時間: 2時間
  - **技術要件**: 運用マニュアルの作成
  - **依存関係**: 初期設定フローの完了

- [ ] メンテナンス手順の確立
  - 定期的なデータ同期確認手順
  - 基本的なエラーログの確認手順
  - ユーザーフィードバックの収集手順
  - 見積時間: 2時間
  - **技術要件**: 運用ドキュメントの整備
  - **依存関係**: 日常運用フローの確立

### Phase 10: 統計・レポート機能
**期間**: デプロイ後
**優先度**: 🟢 通常

- [ ] 統計・レポート機能の実装
  - 勤怠統計の表示
  - 給与レポートの生成
  - 見積時間: 5時間

- [ ] カスタマイズ機能の実装
  - 通知設定のカスタマイズ
  - 表示設定の調整
  - 見積時間: 4時間

### Phase 11: バックアップ・復旧機能
**期間**: デプロイ後
**優先度**: 🟢 通常

- [ ] 自動バックアップ機能の実装
  - データのバックアップ機能
  - データ保護、災害復旧
  - 見積時間: 6時間

---

## 📋 LINE連携機能実装計画（詳細版）

### 🎯 実装概要
LINE連携機能により、既存のグループLINEでのシフト交代連携を維持しながら、システムとの自動連携を実現するLINE Bot機能を構築します。

### 📊 実装スケジュール
- **総期間**: 8-10週間
- **総工数**: 約55時間
- **実装フェーズ**: 6段階（Phase 9-0 ～ 9-5）

### 🔧 技術スタック
- **フレームワーク**: Rails 8.0.2
- **データベース**: SQLite3
- **LINE API**: LINE Messaging API
- **認証**: 既存のメール認証システム
- **バックグラウンドジョブ**: SolidQueue

### 📋 実装詳細

#### Phase 9-0: LINE Bot接続テスト（7時間）
**目標**: LINE Botの基本接続と動作確認

**主要タスク**:
1. **LINE Bot接続テストの実装**（3時間）
   - LINE Botアカウントの作成・設定
   - Webhookエンドポイントの設定
   - 基本的なメッセージ送受信テスト
   - グループ・個人の識別テスト

2. **環境設定の確認**（2時間）
   - LINE_CHANNEL_SECRET、LINE_CHANNEL_TOKENの設定確認
   - 本番環境でのWebhook URL設定
   - SSL証明書の確認（本番環境）

3. **接続テストの実行**（2時間）
   - 個人LINEでのメッセージ送受信テスト
   - グループLINEでのメッセージ送受信テスト
   - エラーハンドリングのテスト

#### Phase 9-1: LINE Bot基盤強化（9時間）
**目標**: LINE Botの基本機能と認証システムの構築

**主要タスク**:
1. **LINE Bot基盤の拡張**（4時間）
   - グループ・個人の識別機能実装
   - 従業員IDとLINEアカウントの紐付け機能
   - 基本的なコマンド処理の拡張

2. **認証システムの拡張**（3時間）
   - 従業員ID入力機能の実装
   - メール認証コード送信機能の統合
   - LINEアカウントとの紐付け機能

3. **データベース設計・実装**（2時間）
   - EmployeeLineAccountモデルの作成
   - LineMessageLogモデルの作成
   - マイグレーションの実行

#### Phase 9-2: 基本機能実装（15時間）
**目標**: シフト確認・交代機能の実装

**主要タスク**:
1. **シフト確認機能の実装**（5時間）
   - 個人シフト確認機能
   - グループ全体シフト確認機能
   - 日別シフト表示機能

2. **シフト交代機能の実装**（6時間）
   - シフト交代依頼機能
   - 承認・否認機能
   - 自動更新機能

3. **コマンド処理システムの実装**（4時間）
   - グループLINEコマンド（シフト交代、承認、否認、全員シフト）
   - 個人LINEコマンド（シフト確認、勤怠確認、給与確認、ヘルプ）
   - エラーハンドリング機能

#### Phase 9-3: 高度な機能実装（12時間）
**目標**: 通知機能と勤怠・給与確認機能の実装

**主要タスク**:
1. **通知機能の実装**（5時間）
   - 打刻リマインダー機能
   - 給与アラート機能
   - シフト変更通知機能

2. **勤怠・給与確認機能の実装**（4時間）
   - 勤怠状況確認機能
   - 103万の壁ゲージ表示機能
   - 給与情報確認機能

3. **メッセージフォーマット・UI設計の実装**（3時間）
   - シフト確認メッセージの実装
   - 給与確認メッセージの実装
   - 全員シフト確認メッセージの実装

#### Phase 9-4: 統合・テスト（10時間）
**目標**: 全機能の統合テストと最適化

**主要タスク**:
1. **統合テストの実装**（4時間）
   - グループLINE機能のテスト
   - 個人LINE機能のテスト
   - シフト交代フローのテスト

2. **エラーハンドリング・例外処理の実装**（3時間）
   - システムエラー時の対応
   - システム障害時の対応
   - 不正コマンド時の対応

3. **パフォーマンス最適化**（3時間）
   - データ同期ルールの実装
   - キャッシュ戦略の実装
   - API呼び出し最適化

#### Phase 9-5: 運用準備（6時間）
**目標**: 運用フローとドキュメントの整備

**主要タスク**:
1. **初期設定フローの実装**（2時間）
   - 店舗のグループLINEにBotを追加する手順
   - 各従業員が個人LINEでBotを友達追加する手順
   - 従業員IDとLINEアカウントの紐付け手順

2. **日常運用フローの確立**（2時間）
   - グループLINEでのシフト交代連携手順
   - 個人LINEでの勤怠・給与確認手順
   - 自動通知による情報共有手順

3. **メンテナンス手順の確立**（2時間）
   - 定期的なデータ同期確認手順
   - 基本的なエラーログの確認手順
   - ユーザーフィードバックの収集手順

### 🎯 実装優先度
1. **Phase 9-0**: 接続テスト（LINE Botの基本動作確認）
2. **Phase 9-1**: 基盤強化（認証・識別機能）
3. **Phase 9-2**: 基本機能（シフト確認・交代）
4. **Phase 9-3**: 高度な機能（通知・勤怠確認）
5. **Phase 9-4**: 統合・テスト
6. **Phase 9-5**: 運用準備

### ⚠️ 注意事項
- **既存機能との連携**: 既存のシフト管理、勤怠管理、給与計算機能を最大限活用
- **セキュリティ**: 個人情報の適切な分離と管理
- **ユーザビリティ**: 既存のLINE利用体験を維持した直感的な操作
- **パフォーマンス**: リアルタイム性とパフォーマンスのバランス

---

## 📋 デプロイ前チェックリスト

### ✅ 完了項目（デプロイ準備完了）
- [x] Phase 6: セキュリティ強化（22時間） ✅ **完了**
  - [x] セッションタイムアウト機能の実装 ✅ **完了**
  - [x] CSRF保護の強化 ✅ **完了**
  - [x] サーバーサイドバリデーションの実装 ✅ **完了**
  - [x] 権限チェックの強化 ✅ **完了**
  - [x] 外部キー制約の追加 ✅ **完了**
  - [x] データベースインデックスの最適化 ✅ **完了**

- [x] Phase 7: 機能修正・安定性向上（10時間） ✅ **完了**
  - [x] シフト交代機能の動作不良修正 ✅ **完了**
  - [x] エラーハンドリングの統一と改善 ✅ **完了**
  - [x] N+1問題の解決 ✅ **完了**
  - [x] freee API呼び出しの最適化 ✅ **完了**
  - [x] ~~ログ機能の実装~~ ❌ **スキップ**

- [x] Phase 8: 本番環境構築・デプロイ（13時間） ✅ **完了**
  - [x] 本番環境設定の完了 ✅ **完了**
  - [x] データベース本番環境準備 ✅ **完了**
  - [x] Fly.ioへのデプロイ ✅ **完了**
  - [x] 本番環境での動作確認 ✅ **完了**
  - [x] ~~監視・アラート設定~~ ❌ **スキップ**
  - [x] ~~ドキュメント整備~~ ❌ **スキップ**

### 📊 実装完了状況（最終版）
- **デプロイ前必須**: 40時間（約5週間） ✅ **完了**
- **完了内訳**:
  - ✅ セキュリティ強化: 17時間（完了）
  - ✅ 機能修正・安定性: 10時間（Phase 7-3スキップ）
  - ✅ 本番環境構築: 13時間（完了）
- **スキップ項目**:
  - ❌ Phase 7-3: ログ・監査機能（4時間）
  - ❌ Phase 8-4: 運用準備（5時間）
- **実装完了**: 2025年9月14日
- **デプロイ状況**: Fly.io本番環境で稼働中

### 更新履歴
- 2024年: TODOファイルの構造化とタスク管理形式への変更
- 基本機能の実装完了
- ドキュメント整備完了
- Rails移行計画の策定（GASの制約により方針転換）
- Rails移行準備完了（データベース設計、ドキュメント整備、不要ファイル削除）
- 2025年1月: UX改善タスクの追加（Phase 4-1）
- 2025年1月: Phase 4-1 UX改善実装完了（5.5時間）
- 2025年1月: フラッシュメッセージのトースト形式化完了
- 2025年1月: 追加UX改善完了（文言統一、alert置き換え、ナビゲーション改善）
- 2025年1月: Phase 4-2 追加UX改善完了（5時間）
- 2025年1月: JavaScriptエラー修正完了、フラッシュメッセージ表示の課題を特定
- 2025年1月: TODO優先順位の再編成（フェーズ順を維持しつつ、UX改善・エラー修正をデプロイ前最優先に設定）
- 2025年1月: Phase 5 UI/UX改善実装完了（ダッシュボード簡素化、ヘッダーナビゲーション、情報再配置、フォームデザイン統一）
- 2025年1月: シフト追加リクエストフォームのデザイン統一完了
- 2025年1月: フラッシュメッセージ表示問題解決、シフト交代機能の動作不良を新規課題として追加
- 2025年1月: シフト追加リクエストエラーの修正完了（変数名不一致とメソッド引数不一致の修正）
- 2025年1月: 認証関連ビューでの従業員IDキー名不一致の修正完了（emp[:employee_id] → emp[:id]）
- 2025年1月: メールテンプレートのCSS適用問題修正完了（<style>タグの追加）
- 2025年1月: ログイン時の従業員選択エラー修正完了（認証関連ビューでのキー名統一）
- 2025年1月: AuthControllerTestの失敗テスト修正完了（setup_initial_password_urlの使用）
- 2025年1月: SCSSファイル統合完了（複数CSSファイルの管理改善）
- 2025年1月: HTML読み込み部分の修正完了（stylesheet_link_tagの修正）
- 2025年1月: テストデータ削除とfreeeAPI完全移行完了（従業員データの一元化）
- 2025年1月: 103万の壁ゲージ読み込み問題修正完了（WageServiceのfreeeAPI連携）
- 2025年1月: ログイン認証システム修正完了（AuthServiceのfreeeAPI統合）
- 2025年1月: シフトリクエスト一覧ページのデザイン改善完了（ボタン色変更、カード幅調整）
- 2025年1月: 不要な_main.scssファイル削除完了（404エラー解消）
- 2025年1月: カード間隔調整とHTML構造簡素化完了（謎の領域削除）
- 2025年1月: 余分な線の削除完了（h1要素のborder-bottom削除）
- 2025年1月: ドキュメント整備完了（README.md更新、API仕様書作成、セットアップガイド作成）
- 2025年1月: TODOファイルの大規模再構築完了（デプロイ前必須項目の整理、優先度の明確化、チェックリストの追加）
- 2025年1月: TODOファイルのフェーズ順序整理完了（完了/未完了の明確化、フェーズ順の整理）
- 2025年1月: Phase 6-1 セキュリティ強化完了（セッションタイムアウト機能、CSRF保護の強化をTDD手法で実装）
- 2025年1月: Phase 6-2 入力値検証と権限チェック完了（テストスイート完全修復、Rails 8.0対応、非推奨警告解消、モジュール一貫適用）
- 2025年1月: Phase 6-3 データベースセキュリティ完了（外部キー制約追加、データベースインデックス最適化、データクリーンアップをTDD手法で実装）
- 2025年1月: Phase 7-1 エラーハンドリング統一・改善完了（ErrorHandlerモジュール作成、統一されたエラーメッセージ、セキュリティ向上、ユーザビリティ改善をTDD手法で実装）
- 2025年1月: Phase 7-2 パフォーマンス最適化完了（N+1問題解決、freee API呼び出し最適化、キャッシュ戦略実装、レート制限実装をTDD手法で実装）
- 2025年1月: Phase 7-3と8-3をスキップ決定（短期的使用アプリケーションのため、時間的制約を考慮しPhase 8-1と8-2に集中）
- 2025年1月: フェーズ8前リファクタリング完了（DRY原則・リーダブル・コード適用、rails testによる挙動維持確認）
- 2025年9月: Fly.ioデプロイ完了（SQLite対応、無料枠活用、環境変数管理、アプリケーション再作成手順確立）
- 2025年9月: ドキュメント整備完了（DEPLOYMENT_GUIDE.md作成、README.md更新、todo.md更新）
- 2025年9月: デプロイ前チェックリスト完了（全必須項目実装完了、本番環境稼働中）
- 2025年9月: Phase 8-1, 8-2完了（本番環境設定、デプロイ・検証完了、Fly.io本番環境稼働中）
- 2025年1月: Phase 9-1 データベース設計仕様変更（EmployeeLineAccountテーブル → Employeeテーブルへのline_id追加、LineMessageLogテーブル作成、各種ドキュメント更新）
- 2025年1月: docsディレクトリ内全ドキュメント更新完了（line-integration.md、line_bot_api_spec.md、line_bot_deployment.md、schema-database.md、implementation-status.md、implementation-details.md）
- 2025年1月: Phase 9-2 基本機能実装完了（シフト確認機能、認証コマンド（従業員名入力・会話状態管理）、コマンド処理システム、TDD手法で実装、223テスト、455アサーション、すべて成功）
- 2025年1月: Phase 9-2 セキュリティ強化完了（全員シフトコマンドに認証チェック追加、グループ・個人チャット適切分離、認証フロー改善、40テスト、77アサーション、すべて成功）
- 2025年1月: シフト交代フロー改善完了（従業員名指定機能、複数人指定機能をTDD手法で実装、75テスト、205アサーション、すべて成功）
- 2025年1月: ユーザーメッセージ文言改善完了（絵文字追加、分かりやすい表現への変更、ユーザビリティ向上）
- 2025年1月: シフト交代機能改善完了（従業員名のみ対応、ID指定機能削除、シフト日選択時の自動従業員リスト表示、listコマンド削除、TDD手法で実装、80テスト、219アサーション、すべて成功）
- 2025年1月: メール通知機能修正完了（Date型の文字列変換エラー修正、メールテンプレート修正、TDD手法で実装、82テスト、227アサーション、すべて成功）
- 2025年1月: ドキュメント整備完了（メール文言改善、LINEコマンド案内追加、実装状況更新、シフト追加リクエスト機能のTODO追加）
- 2025年1月: 仕様変更完了（勤怠状況確認、103万の壁ゲージ表示、給与情報確認機能をLINE Bot対象外に変更、ドキュメント更新）
- 2025年1月: TODOファイル更新完了（シフト追加リクエスト機能のタスク追加、Phase 9-3として進行中に設定、既存タスクの整理）
- 2025年1月: 緊急不具合発見・TODO追加完了（Webアプリ上でのシフト交代リクエスト承認・否認機能の不具合、打刻機能のタイムゾーンずれ、Phase 9-2.5として最優先に設定）
- 2025年1月: Phase 9-2.5 シフト交代承認・否認機能修正完了（TDD手法で実装、外部キー制約エラー・認証エラー・権限チェックエラーの解決、包括的テストスイート作成）
- 2025年1月: ドキュメント整備完了（README.md、実装状況レポート、テスト仕様書、API仕様書、実装詳細ドキュメントの更新）
- 2025年1月: ドキュメント包括的整備完了（全ドキュメントの最新状況反映、緊急不具合情報追加、実装状況更新、README.md作成）