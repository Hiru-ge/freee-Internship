# 勤怠管理システム - タスク管理

## 概要
勤怠管理チェックアプリのタスク管理一覧です。
現在の基本機能は実装完了しており、以下の項目は今後の改善・拡張として管理しています。

## ✅ 完了（Rails移行・既存機能完全移行）

### 移行方針
- **完全再現**: GAS時代の画面と全く同じデザイン・動作
- **機能単位**: 各機能を完全に移行してから次へ
- **段階的コミット**: 各機能完了時にコミット
- **コピペ推奨**: 既存のHTML/CSS/JSを最大限活用

### Rails移行 Phase 1: 基盤構築（最優先）
- [x] Railsアプリケーションの作成
  - 新しいRails 8.0.2アプリケーションの作成
  - 必要なgemの設定（line-bot-api, dotenv-rails等）
  - 基本的なディレクトリ構造の構築
  - 見積時間: 30分

- [x] 基本的なWebhookエンドポイントの実装
  - WebhookControllerの作成
  - LINE Bot SDKの設定
  - 基本的なメッセージ受信・応答機能
  - 見積時間: 30分

### Rails移行 Phase 2: 既存機能完全移行（✅ 完了）

#### Phase 2-1: 認証システム移行（✅ 完了）
- [x] データベース設計・実装
  - employeesテーブル（認証情報のみ）
  - verification_codesテーブル（認証コード管理）
  - マイグレーション実行
  - 見積時間: 30分

- [x] 認証システムの完全移行
  - ログイン画面（view_login.html → app/views/auth/login.html.erb）
  - 初回パスワード設定（view_initial_password.html → app/views/auth/initial_password.html.erb）
  - パスワード変更（view_password_change.html → app/views/auth/password_change.html.erb）
  - パスワード忘れ（view_forgot_password.html → app/views/auth/forgot_password.html.erb）
  - 見積時間: 2時間

- [x] freee API連携の実装
  - FreeeApiService（code-api.js → app/services/freee_api_service.rb）
  - 認証サービス（code-auth.js → app/services/auth_service.rb）
  - 従業員情報の動的取得
  - 実データでのDB再構築
  - 見積時間: 1.5時間

- [x] メール送信機能の実装
  - AuthMailer（Gmail SMTP連携）
  - 認証コード送信機能
  - パスワードリセット機能
  - 見積時間: 1時間

- [x] 環境変数への移行
  - 機密情報の.envファイル分離
  - セキュリティ向上
  - 見積時間: 30分

- [x] 認証機能のテスト・コミット
  - ログイン機能の動作確認
  - パスワード変更機能の動作確認
  - freee API連携の動作確認
  - セッション管理の動作確認
  - コミット: "feat: 認証システムの完全移行"
  - 見積時間: 30分

#### Phase 2-2: マイページ機能移行（✅ 完了）
- [x] マイページ機能の完全移行
  - マイページトップ（view_my_page.html → app/views/dashboard/index.html.erb）
  - 打刻機能（code-clock.js → app/services/clock_service.rb）
  - 勤怠履歴表示
  - 月次ナビゲーション
  - 見積時間: 2時間

- [x] マイページ機能のテスト・コミット
  - 打刻機能の動作確認
  - 勤怠履歴の表示確認
  - コミット: "feat: マイページ・打刻機能の完全移行"
  - 見積時間: 30分

#### Phase 2-3: シフト管理機能移行（✅ 完了）
- [x] シフト管理機能の完全移行
  - シフトページ（view_shift_page.html → app/views/shifts/index.html.erb）
  - シフト表示・確認機能
  - 月次ナビゲーション
  - 見積時間: 1.5時間

- [x] シフト情報のDB取り込み
  - Shiftモデルの作成
  - マイグレーション実行
  - GASテストデータの移植（81件）
  - 見積時間: 1時間

- [x] freee API連携によるシフトデータ取得
  - FreeeApiService#get_employees実装
  - ShiftsController#data実装
  - 従業員情報とシフトデータの統合
  - 見積時間: 1時間

- [x] 103万の壁ゲージのHTML枠作成
  - オーナー向け給与ゲージセクション
  - 従業員向け個人ゲージセクション
  - 実装予定表示
  - 見積時間: 0.5時間

- [x] シフト管理機能のテスト・コミット
  - シフト表示の動作確認
  - ナビゲーションの動作確認
  - GAS版との整合性確認
  - コミット: "feat: シフト管理機能の完全移行"
  - 見積時間: 30分

#### Phase 2-4: シフト交代機能移行 ✅ **完了**
- [x] シフト交代機能の完全移行
  - シフト交代リクエスト（view_shift_request_form.html → app/views/shifts/request.html.erb）
  - シフト交代承認（view_shift_approval.html → app/views/shifts/approval.html.erb）
  - シフト追加依頼（view_shift_add_form.html → app/views/shifts/add.html.erb）
  - 見積時間: 2.5時間

- [x] シフト交代機能のテスト・コミット
  - リクエスト送信の動作確認
  - 承認・否認の動作確認
  - メール通知機能の実装
  - シフト重複チェック機能の実装
  - API互換性（GAS互換）の実装
  - コミット: "feat: シフト交代機能の完全移行"
  - 見積時間: 30分

#### Phase 2-5: 給与管理機能移行 ✅ **完了**
- [x] 給与管理機能の完全移行
  - 103万の壁ゲージ（code-wage.js → app/services/wage_service.rb）
  - 給与計算・表示機能
  - 時間帯別時給システム
  - 見積時間: 2時間

- [x] 給与管理機能のテスト・コミット
  - 給与計算の動作確認
  - ゲージ表示の動作確認
  - 給与一覧画面の実装
  - ダッシュボード・シフトページ統合
  - シフトページデザイン統一（ダークテーマ）
  - 個人給与詳細ページ削除（GASに存在しないため）
  - コミット: "feat: 給与管理機能の完全移行"
  - 見積時間: 30分

### Rails移行 Phase 3: 統合・最適化

#### Phase 3-1: UI・UX統一 ✅ **完了**
- [x] CSS・デザイン統一
  - css.html → app/assets/stylesheets/application.css
  - 全画面のデザイン統一
  - レスポンシブ対応
  - 見積時間: 1時間

- [x] エラーハンドリング統一
  - 統一されたエラー表示システム
  - エラーメッセージの標準化
  - 見積時間: 1時間

- [x] ローディング状態改善
  - プログレスバー、詳細なローディング表示
  - ユーザビリティ向上
  - 見積時間: 1時間

#### Phase 3-2: バックグラウンド処理（✅ 完了）
- [x] 自動通知機能の実装（メール通知）
  - 打刻リマインダーの送信（ClockReminderService、ClockReminderJob）
  - シフト変更通知（ShiftMailer、EmailNotificationService）
  - 認証関連通知（AuthMailer）
  - 見積時間: 2時間

### Rails移行 Phase 4: デプロイ・本番環境構築
- [ ] Herokuへのデプロイ
  - Herokuアプリケーションの作成
  - 環境変数の設定
  - デプロイの実行
  - LINE Webhook URLの設定・検証
  - 見積時間: 1時間

- [ ] 本番環境での動作確認
  - 全機能の動作確認
  - パフォーマンステスト
  - エラーハンドリングの確認
  - 見積時間: 1時間

### LINE連携 Phase 2: 高度な機能（Rails移行完了後）
- [ ] LINE Bot機能の実装
  - 個人LINEでの勤怠状況確認
  - 勤怠データの表示
  - 見積時間: 4時間

- [ ] LINE連携の高度な機能
  - 103万の壁ゲージの状況表示
  - 給与情報の確認
  - 見積時間: 3時間

### LINE連携 Phase 3: 拡張機能（Rails移行完了後）
- [ ] 統計・レポート機能の実装
  - 勤怠統計の表示
  - 給与レポートの生成
  - 見積時間: 5時間

- [ ] カスタマイズ機能の実装
  - 通知設定のカスタマイズ
  - 表示設定の調整
  - 見積時間: 4時間

## 🟡 重要（セキュリティ・安定性）

### セッション有効期限の実装
- [ ] セッションタイムアウト機能の追加
  - 一定時間後の自動ログアウト機能
  - セキュリティ向上、不正アクセス防止
  - 見積時間: 4時間

### 入力値のサーバーサイドバリデーション
- [ ] 各API関数での入力値検証強化
  - サーバーサイドでの厳格な入力値検証
  - データ整合性確保、セキュリティ向上
  - 見積時間: 6時間

### 権限チェックの強化
- [ ] 全API関数での権限チェック追加
  - 各API呼び出しでの権限検証
  - 不正な権限昇格の防止
  - 見積時間: 3時間

## 🟢 通常（ユーザビリティ）

### エラーメッセージの統一
- [ ] 統一されたエラー表示システムの実装
  - `alert()`と`showMessage()`の統一
  - UX向上、一貫性の確保
  - 見積時間: 2時間

### ローディング状態の改善
- [ ] プログレスバー、詳細なローディング表示の実装
  - より詳細な進捗表示
  - ユーザビリティ向上
  - 見積時間: 3時間

### データの整合性チェック
- [ ] データ整合性チェック機能の実装
  - 重複データ、不正データの検出
  - データ品質向上
  - 見積時間: 4時間

## 🟢 通常（機能拡張）

### ログ機能の実装
- [ ] ログ記録システムの実装
  - 操作ログ、エラーログの記録
  - デバッグ支援、監査証跡
  - 見積時間: 5時間

### バックアップ・復旧機能
- [ ] 自動バックアップ機能の実装
  - データのバックアップ機能
  - データ保護、災害復旧
  - 見積時間: 6時間

## 完了済み機能 ✅

### Rails移行準備・ドキュメント整備
- [x] TODOファイルの見直しと既存機能移行の優先順位調整
- [x] データベーススキーマ設計書の作成（既存機能完全移行のためのPostgreSQLスキーマ設計）
- [x] 残りのドキュメントをRails用に書き換え（仕様書、画面設計、LINE連携仕様、完全ガイドの作成）
- [x] 不要になったドキュメントの削除（clasp_setup.md、rails-migration-plan.md、rails-migration-technical-spec.md、rails-setup-guide.md）
- [x] 移行手順の詳細化と機能ごとの集中移行計画策定

### GAS時代の実装済み機能（Rails移行対象）
以下の機能はGAS時代に実装済みで、Rails移行の対象となります：

#### 認証・セキュリティ機能
- 認証設定画面（パスワード変更画面）
- パスワードハッシュ化機能
- ログイン認証機能
- セッション管理機能（基本版）
- 権限管理機能
- パスワードポリシー
- ログアウト機能

#### UI・画面機能
- マイページトップ画面
- シフトページ画面
- ログイン画面
- 初回パスワード設定画面
- パスワード変更画面
- シフト交代リクエスト画面
- シフト交代承認画面
- シフト追加依頼画面

#### コア機能
- 打刻機能（出勤・退勤）
- 勤怠履歴表示
- シフト表示・確認
- シフト交代機能
- 103万の壁ゲージ機能
- 給与計算・表示機能

#### バックグラウンド機能
- 打刻忘れアラート機能
- 退勤打刻リマインダー機能

## タスク管理情報

### 実装優先順位（機能ごとの集中移行）

#### 🔴 最優先: 認証システム移行
1. **Phase 2-1: 認証システム移行**
   - データベース設計・実装
   - 認証システムの完全移行
   - freee API連携の実装
   - 認証機能のテスト・コミット

#### 🟡 重要: コア機能移行
2. **Phase 2-2: マイページ機能移行**
   - マイページ機能の完全移行
   - マイページ機能のテスト・コミット

3. **Phase 2-3: シフト管理機能移行**
   - シフト管理機能の完全移行
   - シフト管理機能のテスト・コミット

#### 🟡 重要: 高度な機能移行
4. **Phase 2-4: シフト交代機能移行** ✅ **完了**
   - シフト交代機能の完全移行
   - シフト交代機能のテスト・コミット

5. **Phase 2-5: 給与管理機能移行** ✅ **完了**
   - 給与管理機能の完全移行
   - 給与管理機能のテスト・コミット

#### 🟢 通常: 統合・最適化
6. **Phase 3-1: UI・UX統一**
   - CSS・デザイン統一
   - エラーハンドリング統一
   - ローディング状態改善

7. **Phase 3-2: バックグラウンド処理**（✅ 完了）
   - 自動通知機能の実装（メール通知完了）

#### 🟢 通常: デプロイ・本番環境
8. **Phase 4: デプロイ・本番環境構築**
   - Herokuへのデプロイ
   - 本番環境での動作確認

#### 🟢 通常: セキュリティ・安定性
9. セッション有効期限の実装
10. 入力値のサーバーサイドバリデーション
11. 権限チェックの強化
12. データの整合性チェック
13. ログ機能の実装
14. バックアップ・復旧機能

#### 🟢 通常: LINE連携（Rails移行完了後）
15. LINE Bot機能の実装
16. LINE連携の高度な機能
17. 統計・レポート機能の実装
18. カスタマイズ機能の実装

### 進捗状況
- **完了済み**: 基本機能、認証機能、UI機能、ドキュメント整備、Rails移行準備、Rails移行 Phase 1完了、Phase 2-1 認証システム移行完了、Phase 2-2 マイページ機能移行完了、Phase 2-3 シフト管理機能移行完了、Phase 2-4 シフト交代機能移行完了、Phase 2-5 給与管理機能移行完了、Phase 2-6 メール機能移行完了、Phase 3-1 UI・UX統一完了、Phase 3-2 バックグラウンド処理完了、Phase 4-1 UX改善実装完了、Phase 4-2 追加UX改善完了
- **🔴 最優先（デプロイ前必須）**: Phase 4-3 シフト交代機能修正（2時間）、エラーハンドリング統一（2時間）、Phase 5 UX改善・情報設計見直し（4-6週間）
- **🟢 デプロイ**: Phase 4 デプロイ・本番環境構築（2時間）
- **🟡 重要（セキュリティ・安定性）**: セッション有効期限、入力値バリデーション、権限チェック強化（13時間）
- **🟢 通常（機能拡張）**: ログ機能、バックアップ・復旧機能（11時間）
- **🟢 通常（LINE連携）**: LINE Bot機能、統計・レポート機能（16時間）
- **総見積時間**: デプロイ前必須: 4時間 + 4-6週間、デプロイ: 2時間、その他: 40時間

### 最新の完了状況（2025年1月）
- **Phase 2-6: メール機能移行** ✅ **完了**
  - メール送信基盤の構築（ActionMailer、Gmail SMTP）
  - 認証関連メールの実装（パスワードリセット、初回設定）
  - シフト関連メールの実装（交代・追加の依頼・承認・否認）
  - 打刻リマインダーメールの実装（出勤・退勤リマインダー）
  - メール送信エラーの修正とテスト完了
  - コードクリーンアップとドキュメント整備

- **Phase 3-2: バックグラウンド処理** ✅ **完了**
  - 自動通知機能の実装（メール通知）
    - ClockReminderService: 打刻リマインダー処理
    - ClockReminderJob: バックグラウンドジョブ
    - ShiftMailer: シフト関連通知
    - AuthMailer: 認証関連通知
    - EmailNotificationService: メール送信の一元管理

- **Phase 3-1: UI・UX統一** ✅ **完了**
  - CSS・デザイン統一の実装（GAS版の全スタイルをRails版に統合）
  - 統一されたエラー表示システムの実装（MessageHandler）
  - 統一されたローディング表示システムの実装（LoadingHandler）
  - プログレスバー・詳細ローディング表示の実装
  - 全画面での一貫したUI・UX体験の実現
  - レスポンシブ対応の強化
  - 後方互換性の確保（フォールバック機能）

- **Phase 2-5: 給与管理機能移行** ✅ **完了**
  - 時間帯別時給計算機能の実装
  - 月間勤務時間計算機能の実装
  - 給与計算（103万の壁）機能の実装
  - 給与一覧画面の実装
  - ダッシュボード・シフトページへの給与ゲージ統合
  - シフトページデザイン統一（ダークテーマ）
  - 個人給与詳細ページ削除（GASに存在しないため）
  - GASと同等の給与管理機能を実現
  - API接続エラーの解決

- **Phase 2-3: シフト管理機能移行** ✅ **完了**
  - シフトページの完全移行（view_shift_page.html → shifts/index.html.erb）
  - シフト表示・確認機能の実装
  - 月次ナビゲーション機能の実装
  - freee API連携によるシフトデータ取得
  - シフト情報のDB取り込み（81件のシフトデータ）
  - 103万の壁ゲージのHTML枠作成
  - GAS版との整合性確保

### 移行手順の詳細

#### 各機能の移行手順
1. **GASファイルの確認**: `backup/gas-files/src/` から対象ファイルを特定
2. **Railsファイルの作成**: 対応するRailsファイルを作成
3. **完全再現**: GAS時代の画面と全く同じデザイン・動作を実現
4. **テスト**: 機能の動作確認を徹底
5. **コミット**: 機能完了時にコミット

#### ファイルマッピング
- `view_login.html` → `app/views/auth/login.html.erb`
- `view_my_page.html` → `app/views/dashboard/index.html.erb`
- `view_shift_page.html` → `app/views/shifts/index.html.erb`
- `code-auth.js` → `app/services/auth_service.rb`
- `code-api.js` → `app/services/freee_api_service.rb`
- `css.html` → `app/assets/stylesheets/application.css`

### 関連仕様
- 仕様書: `docs/requirement.md`（Rails版）
- 画面設計: `docs/screen-design.md`（Rails版）
- LINE連携仕様: `docs/line-integration.md`（Rails版）
- データベーススキーマ設計: `docs/database-schema-design.md`
- Rails移行完全ガイド: `docs/rails-migration-complete-guide.md`
- 103万ゲージ実装状況: `docs/103万ゲージ実装状況.md`

## 🟡 重要（UX改善・ユーザビリティ向上）

### Phase 4-3: 残存課題の解決 🔴 **優先度高**
- [x] フラッシュメッセージ表示の完全修正 ✅ **完了**
  - 課題: シフト交代リクエストの部分成功メッセージがトースト通知で正しく表示されない
  - 現状: 部分成功メッセージは正常に表示されることを確認
  - 見積時間: 1.5時間
  - 優先度: 高

- [ ] シフト交代機能の動作不良修正 🔴 **新規課題**
  - 課題: シフト交代機能自体がうまく動作しない問題
  - 現状: 部分成功メッセージは表示されるが、シフト交代処理に問題あり
  - 見積時間: 2時間
  - 優先度: 高

- [ ] エラーハンドリングの統一と改善
  - 全画面でのエラーメッセージ表示の一貫性確保
  - ユーザーフレンドリーなエラーメッセージの実装
  - エラー発生時の適切なフォールバック処理
  - 見積時間: 2時間
  - 優先度: 高

### Phase 4-1: UX改善実装（完了済み） ✅ **完了**
- [x] 自分のシフト以外をクリックできないようにする
  - シフト表で自分のシフトのみクリック可能にする
  - 他人のシフトは視覚的にクリック不可であることを示す
  - 見積時間: 1時間

- [x] シフト交換依頼時の依頼元変更制限
  - 申請者フィールドを読み取り専用にして変更不可にする
  - 依頼元は必ず自分なので変更できないようにする
  - 見積時間: 0.5時間

- [x] 全ユーザー表示時のIDソート
  - 従業員一覧をID順でソートして表示する
  - シフト交換依頼フォームの従業員選択でもID順ソート
  - 見積時間: 0.5時間

- [x] 各所の文言修正
  - より分かりやすい文言に変更する
  - ユーザーにとって理解しやすい表現に統一
  - 見積時間: 1時間

- [x] トースト形式のメッセージ表示
  - エラーや成功時のメッセージをトースト形式で表示する
  - 既存のMessageHandlerを活用して統一感を保つ
  - 見積時間: 1.5時間

- [x] 詳細なエラー文言
  - エラーメッセージをより具体的で分かりやすくする
  - ユーザーが対処しやすい情報を提供
  - 見積時間: 1時間

### Phase 4-2: 追加UX改善（完了済み） ✅ **完了**
- [x] 文言の不整合修正
  - 「ホーム画面」を「シフトページ」に統一
  - 戻るボタンの文言を実際の遷移先と一致させる
  - 見積時間: 1時間

- [x] 残りのalertをトースト形式に変更
  - 各ビューファイルのalert呼び出しをwindow.messageHandler.showに置換
  - フォールバック機能の実装
  - 見積時間: 1時間

- [x] 複数人へのシフト交代リクエストで部分成功時の詳細メッセージ実装
  - ShiftOverlapServiceにget_available_and_overlapping_employeesメソッド追加
  - 利用可能な従業員のみにリクエスト送信
  - 重複している従業員の名前を含む詳細な成功メッセージ
  - 見積時間: 1.5時間
  - **注意**: バックエンドロジックは正常動作、フロントエンド表示に課題あり

- [x] JavaScriptエラーの修正とフラッシュメッセージ表示の改善
  - 変数名の重複エラー修正（style → messageStyle, loadingStyle）
  - DOM要素の存在チェック追加
  - 初期化タイミングの改善
  - エラーハンドリングの強化
  - 見積時間: 1.5時間
  - **注意**: JavaScriptエラーは修正済み、フラッシュメッセージ表示の微調整が必要

## 🟡 重要（UI/UX改善・情報設計最適化）

### Phase 5: UI/UX改善実装 ✅ **完了**
**期間**: 4-6週間

#### Phase 5-1: ダッシュボード簡素化 ✅ **完了**
**期間**: 1-2週間

- [x] ダッシュボードビューの更新
  - [x] 103万の壁ゲージセクションを削除
    - [x] `app/views/dashboard/index.html.erb`から該当セクションを削除
    - [x] 関連するCSSクラスを削除
    - [x] JavaScriptの給与ゲージ関連コードを削除
  - [x] 月別勤怠履歴を今月の履歴のみに変更
    - [x] 月別ナビゲーションボタンを削除
    - [x] 今月の勤怠履歴のみ表示するように変更
    - [x] 「詳細を見る」リンクを勤怠履歴ページへ誘導
  - [x] 打刻ボタンのデザイン改善
    - [x] ボタンサイズを大きくする
    - [x] テキストの配置を改善
    - [x] ホバー効果とアニメーションを追加
    - [x] レスポンシブ対応（モバイルでの表示最適化）
    - [x] テキストベースの表示に変更
  - [x] ナビゲーションをクイックアクセスに変更
    - [x] 既存のナビゲーションリンクを削除
    - [x] クイックアクセスリンクを追加
    - [x] シンプルなデザインに変更

- [x] コントローラーの更新
  - [x] `DashboardController`の修正
    - [x] 給与情報の取得処理を削除
    - [x] 今月の勤怠履歴取得処理を追加
    - [x] 不要なインスタンス変数を削除

- [x] スタイリングの更新
  - [x] ダッシュボード専用CSSの作成
    - [x] 打刻ボタンの強調スタイル
    - [x] 今月の勤怠履歴の表示スタイル
    - [x] クイックアクセスのスタイル
    - [x] レスポンシブ対応

#### Phase 5-2: ヘッダーナビゲーション導入 ✅ **完了**
**期間**: 1-2週間

- [x] ヘッダーコンポーネントの作成
  - [x] `app/views/shared/_header.html.erb`の作成
    - [x] ロゴとブランド名の表示
    - [x] ナビゲーションメニューの実装
    - [x] 権限管理による表示制御
    - [x] アクティブ状態の管理
    - [x] 現在ログインしているユーザー情報の表示
    - [x] テキストベースの表示に変更
  - [x] ヘッダー専用CSSの作成
    - [x] デスクトップ版のスタイル
    - [x] モバイル版（ハンバーガーメニュー）のスタイル
    - [x] レスポンシブ対応
    - [x] アニメーション効果

- [x] レイアウトファイルの更新
  - [x] `app/views/layouts/application.html.erb`の更新
    - [x] ヘッダーコンポーネントの読み込み
    - [x] 既存のナビゲーション削除
    - [x] メタタグとSEO設定の確認

- [x] JavaScript機能の実装
  - [x] モバイルメニューの動作
    - [x] ハンバーガーメニューの開閉
    - [x] メニュー外クリックでの自動クローズ
    - [x] アクティブ状態の管理
  - [x] ナビゲーション機能
    - [x] 現在ページのハイライト
    - [x] スムーススクロール
    - [x] キーボードナビゲーション対応

- [x] 権限管理の実装
  - [x] オーナー権限の表示制御
    - [x] 給与メニューの表示/非表示
    - [x] 管理機能へのアクセス制御
    - [x] セキュリティの確認

#### Phase 5-3: 情報再配置と新規ページ ✅ **完了**
**期間**: 2-3週間

- [x] シフトページへの給与ゲージ統合
  - [x] シフトページビューの更新
    - [x] オーナー向け：全従業員の給与状況一覧
    - [x] 従業員向け：個人の給与ゲージ
    - [x] 既存のシフト表との統合
  - [x] `ShiftsController`の修正
    - [x] 給与情報の取得処理を追加
    - [x] オーナー/従業員別の表示制御
    - [x] パフォーマンスの最適化
  - [x] スタイリングの調整
    - [x] 給与ゲージの表示スタイル
    - [x] シフト表とのレイアウト調整
    - [x] レスポンシブ対応

- [x] 勤怠履歴機能の統合
  - [x] ダッシュボードでの月別勤怠履歴表示
    - [x] ページネーション機能の復活
    - [x] 前月/次月ナビゲーション
    - [x] 勤怠履歴テーブル表示
  - [x] 専用ページの削除
    - [x] `app/views/dashboard/attendance_history_page.html.erb`の削除
    - [x] 関連ルーティングの削除
    - [x] コントローラーアクションの削除

- [x] 設定ページの統合
  - [x] 既存コントローラーの活用
    - [x] `AuthController`の`password_change`アクションを拡張
    - [x] アカウント情報の表示機能追加
    - [x] その他の設定項目の追加
  - [x] ナビゲーションの最適化
    - [x] 各画面からの不要なナビゲーション削除
    - [x] ヘッダーナビゲーションとの統合
    - [x] 一貫性の確保

#### Phase 5-4: UX改善とテスト ✅ **完了**
**期間**: 1-2週間

- [x] アクセシビリティの向上
  - [x] WCAG 2.1 AA準拠の確認
    - [x] キーボードナビゲーション対応
    - [x] スクリーンリーダー対応
    - [x] 色のコントラスト比の確認
    - [x] フォーカス表示の改善
  - [x] セマンティックHTMLの実装
    - [x] 適切なHTMLタグの使用
    - [x] ARIA属性の追加
    - [x] ラベルの適切な関連付け

- [x] ユーザビリティテストの実施
  - [x] テスト計画の作成
    - [x] テストシナリオの定義
    - [x] テストユーザーの選定
    - [x] 評価指標の設定
  - [x] テストの実施
    - [x] 打刻機能の使いやすさテスト
    - [x] ナビゲーションの直感性テスト
    - [x] レスポンシブ対応のテスト
    - [x] エラー処理のテスト
  - [x] 結果の分析と改善
    - [x] テスト結果の分析
    - [x] 問題点の特定
    - [x] 改善案の作成
    - [x] 優先度の設定

- [x] パフォーマンス最適化
  - [x] ページ読み込み速度の改善
    - [x] 画像の最適化
    - [x] CSS/JavaScriptの圧縮
    - [x] キャッシュの設定
  - [x] データベースクエリの最適化
    - [x] N+1問題の解決
    - [x] インデックスの追加
    - [x] クエリの最適化

- [x] バグ修正と微調整
  - [x] 既知の問題の修正
    - [x] レイアウトの崩れ修正
    - [x] JavaScriptエラーの修正
    - [x] レスポンシブ表示の調整
  - [x] 最終調整
    - [x] デザインの微調整
    - [x] アニメーションの調整
    - [x] ユーザーフィードバックの反映

### Rails移行 Phase 4: デプロイ・本番環境構築
- [ ] Herokuへのデプロイ
  - Herokuアプリケーションの作成
  - 環境変数の設定
  - デプロイの実行
  - LINE Webhook URLの設定・検証
  - 見積時間: 1時間

- [ ] 本番環境での動作確認
  - 全機能の動作確認
  - パフォーマンステスト
  - エラーハンドリングの確認
  - 見積時間: 1時間

### 更新履歴
- 2024年: TODOファイルの構造化とタスク管理形式への変更
- 基本機能の実装完了
- ドキュメント整備完了
- Rails移行計画の策定（GASの制約により方針転換）
- Rails移行準備完了（データベース設計、ドキュメント整備、不要ファイル削除）
- 2025年1月: UX改善タスクの追加（Phase 4-1）
- 2025年1月: Phase 4-1 UX改善実装完了（5.5時間）
- 2025年1月: フラッシュメッセージのトースト形式化完了
- 2025年1月: 追加UX改善完了（文言統一、alert置き換え、ナビゲーション改善）
- 2025年1月: Phase 4-2 追加UX改善完了（5時間）
- 2025年1月: JavaScriptエラー修正完了、フラッシュメッセージ表示の課題を特定
- 2025年1月: TODO優先順位の再編成（フェーズ順を維持しつつ、UX改善・エラー修正をデプロイ前最優先に設定）
- 2025年1月: Phase 5 UI/UX改善実装完了（ダッシュボード簡素化、ヘッダーナビゲーション、情報再配置、フォームデザイン統一）
- 2025年1月: シフト追加リクエストフォームのデザイン統一完了
- 2025年1月: フラッシュメッセージ表示問題解決、シフト交代機能の動作不良を新規課題として追加
- 2025年1月: シフト追加リクエストエラーの修正完了（変数名不一致とメソッド引数不一致の修正）
- 2025年1月: 認証関連ビューでの従業員IDキー名不一致の修正完了（emp[:employee_id] → emp[:id]）
- 2025年1月: メールテンプレートのCSS適用問題修正完了（<style>タグの追加）
- 2025年1月: ログイン時の従業員選択エラー修正完了（認証関連ビューでのキー名統一）
- 2025年1月: AuthControllerTestの失敗テスト修正完了（setup_initial_password_urlの使用）
- 2025年1月: SCSSファイル統合完了（複数CSSファイルの管理改善）
- 2025年1月: HTML読み込み部分の修正完了（stylesheet_link_tagの修正）
- 2025年1月: テストデータ削除とfreeeAPI完全移行完了（従業員データの一元化）
- 2025年1月: 103万の壁ゲージ読み込み問題修正完了（WageServiceのfreeeAPI連携）
- 2025年1月: ログイン認証システム修正完了（AuthServiceのfreeeAPI統合）
- 2025年1月: シフトリクエスト一覧ページのデザイン改善完了（ボタン色変更、カード幅調整）
- 2025年1月: 不要な_main.scssファイル削除完了（404エラー解消）
- 2025年1月: カード間隔調整とHTML構造簡素化完了（謎の領域削除）
- 2025年1月: 余分な線の削除完了（h1要素のborder-bottom削除）
- 2025年1月: ドキュメント整備完了（README.md更新、API仕様書作成、セットアップガイド作成）
